


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>MiniGrid &mdash; DI-engine 0.1.0 documentation</title>
  

  <link rel="shortcut icon" href="../_static/images/favicon.ico" />
  
  

  

  
  
  

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/style.css" type="text/css" />
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="next" title="Slime Volleyball" href="slime_volleyball.html" />
  <link rel="prev" title="BipedalWalker" href="bipedalwalker.html" />
    <link href="../_static/css/style.css" rel="stylesheet" type="text/css">


  
  <script src="../_static/js/modernizr.min.js"></script>
  <script>
    MathJax = {
        chtml: {
            scale: 1,
            minScale: 1,
        },
        svg: {
            scale: 1,
            minScale: 1,
        }
    }
</script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"
    integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://di-engine-docs.readthedocs.io/en/latest/"
        aria-label="OpenMMLab"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://github.com/opendilab/DI-engine" target="_blank">GitHub</a>
          </li>
          <li >
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a
                class="resource-option with-down-arrow">
                OpenDILab
              </a>
              <div class="resources-dropdown-menu">
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/DI-engine" target="_blank">
                  <span class="dropdown-title">DI-engine </span>
                  <p>OpenDILab Decision AI Engine</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/DI-star" target="_blank">
                  <span class="dropdown-title">DI-star </span>
                  <p>OpenDILab Decision AI in StarCraftII</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/DI-drive" target="_blank">
                  <span class="dropdown-title">DI-drive </span>
                  <p>OpenDILab Auto-driving platform</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/GoBigger" target="_blank">
                  <span class="dropdown-title">GoBigger </span>
                  <p>OpenDILab Multi-Agent Environment</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/DI-smartcross" target="_blank">
                  <span class="dropdown-title">DI-smartcross </span>
                  <p>Decision Intelligence Platform for Traffic Crossing Signal Control</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/DI-treetensor" target="_blank">
                  <span class="dropdown-title">DI-treetensor </span>
                  <p>Tree Nested PyTorch Tensor Lib</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/awesome-model-based-RL" target="_blank">
                  <span class="dropdown-title">awesome-model-based-RL </span>
                  <p>A curated list of awesome model based RL resources (continually updated)</p>
                </a>
              </div>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>
  </div>
</div>

<body class="pytorch-body">

   

  

  <div class="table-of-contents-link-wrapper">
    <span>Table of Contents</span>
    <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
  </div>

  <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
    <div class="pytorch-side-scroll">
      <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <div class="pytorch-left-menu-search">
          

          
          
          
          

          



<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        
        
        
        
        
        <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../00_intro/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_quickstart/index.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_algo/index.html">RL Algorithm Taxonomy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_system/index.html">System Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_best_practice/index.html">Best Practice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_api_doc/index.html">API Doc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06_faq/index.html">FAQ</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reinforcement Learning Tutorial</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../10_concepts/index.html">Introduction to RL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11_dizoo/index.html">Learn From DI-zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../12_policies/index.html">RL Algorithms Cheat Sheet</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">RL Env Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Specification</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../20_spec/index.html">Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../21_code_style/index.html">Code Style Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../22_test/index.html">Unit Test Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../23_visual/index.html">Diagrams and Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../24_cooperation/index.html">Github Cooperation</a></li>
</ul>

        
        
      </div>
    </div>
  </nav>

  <div class="pytorch-container">
    <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
      <div class="pytorch-breadcrumbs-wrapper">
        















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../index.html">
            Docs
        </a> &gt;
      </li>

        
          <li><a href="index.html">RL Env Examples</a> &gt;</li>
        
      <li>MiniGrid</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="../_sources/13_envs/minigrid.rst.txt" rel="nofollow"><img src="../_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
      </div>

      <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
        Shortcuts
      </div>
    </div>

    <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
      <div class="pytorch-content-left">
        
          <div class="rst-content">
            
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
              <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
                
  <section id="minigrid">
<h1>MiniGrid<a class="headerlink" href="#minigrid" title="Permalink to this headline">¶</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>MiniGrid, that is, the minimized grid world environment, is a classic discrete action space reinforcement learning environment with sparse rewards, and is often used as a benchmark test environment for sparse reinforcement learning algorithms under discrete action space conditions.
In this game, the agent needs to learn to select the appropriate action in a discrete action set, complete the move in the grid world, obtain the key, open the door and a series of sequential decisions to reach the target position.
It has many different implementation versions, which are mainly introduced here
<a class="reference external" href="https://github.com/maximecb/gym-minigrid">MiniGrid</a>, because its implementation is simple, lightweight, less code dependencies, and easy to install.
It includes MiniGrid-Empty-8x8-v0, MiniGrid-FourRooms-v0, MiniGrid-DoorKey-16x16-v0, MiniGrid-KeyCorridorS3R3-v0,
A series of environments such as MiniGrid-ObstructedMaze-2Dlh-v0, MiniGrid-ObstructedMaze-Full-v0, etc. The picture below shows the MiniGrid-DoorKey-16x16-v0 game.</p>
<a class="reference internal image-reference" href="../_images/MiniGrid-DoorKey-16x16-v0.png"><img alt="../_images/MiniGrid-DoorKey-16x16-v0.png" class="align-center" src="../_images/MiniGrid-DoorKey-16x16-v0.png" style="width: 240.6px; height: 249.6px;" /></a>
</section>
<section id="install">
<h2>Install<a class="headerlink" href="#install" title="Permalink to this headline">¶</a></h2>
<section id="installation-method">
<h3>Installation Method<a class="headerlink" href="#installation-method" title="Permalink to this headline">¶</a></h3>
<p>Users can choose to install via pip one-click or git clone the repository and then pip install locally.</p>
<p>Note: If the user does not have root privileges, please add –user after the install command</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1"># Method1: Install Directly</span>
pip install gym-minigrid
<span class="c1"># Method2: First clone this repository and install the dependencies with pip</span>
git clone https://github.com/maximecb/gym-minigrid.git
<span class="nb">cd</span> gym-minigrid
pip install -e .
</pre></div>
</div>
</section>
<section id="verify-installation">
<h3>Verify Installation<a class="headerlink" href="#verify-installation" title="Permalink to this headline">¶</a></h3>
<p>After the installation is complete, you can run the following command on the Python command line. If the interactive interface of the game is displayed, the installation is successful:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="n">cd</span> <span class="n">gym</span><span class="o">-</span><span class="n">minigrid</span>
<span class="o">./</span><span class="n">manual_contril</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">env</span> <span class="n">MiniGrid</span><span class="o">-</span><span class="n">Empty</span><span class="o">-</span><span class="mi">8</span><span class="n">x8</span><span class="o">-</span><span class="n">v0</span>
</pre></div>
</div>
</section>
</section>
<section id="space-before-transformation-original-environment">
<h2>Space before Transformation (Original Environment)<a class="headerlink" href="#space-before-transformation-original-environment" title="Permalink to this headline">¶</a></h2>
<section id="observation-space">
<h3>Observation Space<a class="headerlink" href="#observation-space" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Take MiniGrid-Empty-8x8-v0 as an example,</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;MiniGrid-Empty-8x8-v0&#39;</span><span class="p">)</span>
<span class="n">obs1</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span> <span class="c1"># obs: {&#39;image&#39;: numpy.ndarray (7, 7, 3),&#39;direction&#39;: ,&#39;mission&#39;: ,}</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">RGBImgPartialObsWrapper</span><span class="p">(</span><span class="n">env</span><span class="p">)</span> <span class="c1"># Get pixel observations</span>
<span class="n">obs2</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span> <span class="c1"># obs: {&#39;mission&#39;: ,&#39;image&#39;: numpy.ndarray (56, 56, 3)}</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">ImgObsWrapper</span><span class="p">(</span><span class="n">env</span><span class="p">)</span> <span class="c1"># Get rid of the &#39;mission&#39; field</span>
<span class="n">obs3</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span> <span class="c1"># obs: numpy.ndarray (56, 56, 3)</span>

<span class="c1"># This FlatObsWrapper cannot be used after using the above Wrapper, it should be used alone</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;MiniGrid-Empty-8x8-v0&#39;</span><span class="p">)</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">FlatObsWrapper</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
<span class="n">obs4</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span> <span class="c1"># obs: numpy.ndarray (56, 56, 3)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>obs1 is a <code class="docutils literal notranslate"><span class="pre">dict</span></code>, including <code class="docutils literal notranslate"><span class="pre">image</span></code>, <code class="docutils literal notranslate"><span class="pre">direction</span></code>, <code class="docutils literal notranslate"><span class="pre">mission</span></code>, these 3 fields, of which <code class="docutils literal notranslate"><span class="pre">image</span></code>  field is a shape <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> of (7, 7, 3), data type <code class="docutils literal notranslate"><span class="pre">uint8</span></code>(7, 7) means that only the world in the nearby 7x7 squares is observed (because the environment is partially observable), 3 means that each small square corresponds to a 3-dimensional description vector, note that this is not a real image; <code class="docutils literal notranslate"><span class="pre">The</span> <span class="pre">direction</span></code>field is to give an instructive direction;
The <code class="docutils literal notranslate"><span class="pre">mission</span></code> field is a text string describing what the agent should achieve in order to receive a reward.</p></li>
<li><p>If the user wants to use the real pixel image, he needs to encapsulate the env through <code class="docutils literal notranslate"><span class="pre">RGBImgPartialObsWrapper</span></code>, obs2 is a <code class="docutils literal notranslate"><span class="pre">dict</span></code>, including <code class="docutils literal notranslate"><span class="pre">mission</span></code> ,  <code class="docutils literal notranslate"><span class="pre">image</span></code> These 2 fields, where <code class="docutils literal notranslate"><span class="pre">image</span></code>field is a <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>of shape (56, 56, 3), and the data type is <code class="docutils literal notranslate"><span class="pre">uint8</span></code>
is a true image of the environment being partially observable;</p></li>
<li><p>After passing <code class="docutils literal notranslate"><span class="pre">ImgObsWrapper</span></code>, obs3 is a <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, shape is (56, 56, 3), data type is <code class="docutils literal notranslate"><span class="pre">uint8</span></code></p></li>
<li><p>Our codebase uses a 4th <code class="docutils literal notranslate"><span class="pre">FlatObsWrapper</span></code>method, which encodes the mission string in the <code class="docutils literal notranslate"><span class="pre">mission</span></code>field in a one-hot way,
And concatenate it with the <code class="docutils literal notranslate"><span class="pre">image</span></code>field content into a <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> obs4 with shape (2739,) and data type <code class="docutils literal notranslate"><span class="pre">float32</span></code></p></li>
</ul>
</section>
<section id="action-space">
<h3>Action Space<a class="headerlink" href="#action-space" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>The game operation button space, generally a discrete action space with a size of 7, the data type is <code class="docutils literal notranslate"><span class="pre">int</span></code>, you need to pass in a python value (or a 0-dimensional np array, for example, action 3 is <code class="docutils literal notranslate"><span class="pre">np.array</span> <span class="pre">(3)</span></code>)</p></li>
<li><p>Action takes value in 0-6, the specific meaning is:</p>
<blockquote>
<div><ul class="simple">
<li><p>0: left</p></li>
<li><p>1: right</p></li>
<li><p>2: up</p></li>
<li><p>3: toggle</p></li>
<li><p>4: pickup</p></li>
<li><p>5: drop</p></li>
<li><p>6: done/noop</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Refer to <a class="reference external" href="https://github.com/maximecb/gym-minigrid/blob/master/manual_control.py">MiniGrid manual_control.py</a> , the keyboard key-action correspondence is:</p>
<blockquote>
<div><ul class="simple">
<li><p>‘arrow left’: left</p></li>
<li><p>‘arrow right’: right</p></li>
<li><p>‘arrow up’: up</p></li>
<li><p>‘ ‘: toggle</p></li>
<li><p>‘pageup’: pickup</p></li>
<li><p>‘pagedown’: drop</p></li>
<li><p>‘enter’: done/noop</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
<section id="bonus-space">
<h3>Bonus Space<a class="headerlink" href="#bonus-space" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Game score, different minigrid sub-environments have a small difference in the reward range, the maximum value is 1, which is generally a <code class="docutils literal notranslate"><span class="pre">float</span></code>value. Because it is a sparse reward environment, it can only be reached when the agent (displayed as a red point) reaches goal(displayed as green dots), there is a reward greater than zero. The specific value is determined by different environments and the total number of steps used to reach the goal. The reward before reaching the goal is all 0.</p></li>
</ul>
</section>
<section id="other">
<h3>Other<a class="headerlink" href="#other" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>The game ends when the agent reaches the green goal or reaches the maximum step limit of the environment.</p></li>
</ul>
</section>
</section>
<section id="key-facts">
<h2>Key Facts<a class="headerlink" href="#key-facts" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>The observation input can be an image in the form of pixels or an “image” with specific semantics, or a textual string describing what the agent should achieve in order to obtain a reward.</p></li>
<li><p>Discrete action spaces.</p></li>
<li><p>Sparse reward, the scale of reward value changes is small, the maximum is 1, and the minimum is 0.</p></li>
</ol>
</section>
<section id="transformed-space-rl-environment">
<h2>Transformed Space (RL environment)<a class="headerlink" href="#transformed-space-rl-environment" title="Permalink to this headline">¶</a></h2>
<section id="id1">
<h3>Observation Space<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Transform content: Our codebase uses a 4th <code class="docutils literal notranslate"><span class="pre">FlatObsWrapper</span></code>method, which encodes the mission string in the <code class="docutils literal notranslate"><span class="pre">mission</span></code>field in a one-hot fashion and combines it with <code class="docutils literal notranslate"><span class="pre">image</span></code>field contents are concatenated into a long array</p></li>
<li><p>Transformation result: one-dimensional np array with size <code class="docutils literal notranslate"><span class="pre">(2739,)</span></code>, data type <code class="docutils literal notranslate"><span class="pre">np.float32</span></code>, value <code class="docutils literal notranslate"><span class="pre">[0.,</span> <span class="pre">7.]</span></code></p></li>
</ul>
</section>
<section id="id2">
<h3>Action Space<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Basically no transformation, it is still a discrete action space of size N=7, generally a one-dimensional np array, the size is <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">)</span></code>, and the data type is <code class="docutils literal notranslate"><span class="pre">np.int64</span></code></p></li>
</ul>
</section>
<section id="id3">
<h3>Bonus Space<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Transform content: basically no transform</p></li>
</ul>
<p>The above space can be expressed as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gym</span>

<span class="n">obs_space</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2739</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">act_space</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="n">rew_space</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id4">
<h3>Other<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">info</span></code>returned by the environment <code class="docutils literal notranslate"><span class="pre">step</span></code>method must contain the <code class="docutils literal notranslate"><span class="pre">final_eval_reward</span></code>key-value pair, which represents the evaluation index of the entire episode, and is the cumulative sum of the rewards of the entire episode in minigrid</p></li>
</ul>
</section>
</section>
<section id="id5">
<h2>Other<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<section id="random-seed">
<h3>Random Seed<a class="headerlink" href="#random-seed" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>There are two parts of random seeds in the environment that need to be set, one is the random seed of the original environment, and the other is the random seed of the random library used by various environment transformations (such as <code class="docutils literal notranslate"><span class="pre">random</span></code>, <code class="docutils literal notranslate"><span class="pre">np.random</span></code>)</p></li>
<li><p>For the environment caller, just set these two seeds through the <code class="docutils literal notranslate"><span class="pre">seed</span></code>method of the environment, and do not need to care about the specific implementation details</p></li>
<li><dl class="simple">
<dt>The specific implementation inside the environment: for random library seeds, set the value directly in the <code class="docutils literal notranslate"><span class="pre">seed</span></code>method of the environment; for the seed of the original environment, inside the <code class="docutils literal notranslate"><span class="pre">reset</span></code>method of the calling environment, The specific original environment<code class="docutils literal notranslate"><span class="pre">reset</span></code>was previously set to seed + np_seed, where seed is the value of the aforementioned random library seed,</dt><dd><p>np_seed = 100 * np.random.randint(1, 1000).</p>
</dd>
</dl>
</li>
</ul>
</section>
<section id="the-difference-between-training-and-testing-environments">
<h3>The difference between training and testing environments<a class="headerlink" href="#the-difference-between-training-and-testing-environments" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>The training environment uses a dynamic random seed, that is, the random seed of each episode is different, generated by a random number generator, and the seed of this random number generator is fixed by the <code class="docutils literal notranslate"><span class="pre">seed</span></code>method of the environment; test The environment uses a static random seed, i.e. the same random seed for each episode, specified by the <code class="docutils literal notranslate"><span class="pre">seed</span></code>method.</p></li>
</ul>
</section>
<section id="store-video">
<h3>Store Video<a class="headerlink" href="#store-video" title="Permalink to this headline">¶</a></h3>
<p>After the environment is created, but before reset, call the <code class="docutils literal notranslate"><span class="pre">enable_save_replay</span></code>method to specify the path to save the game recording. The environment will automatically save the local video files after each episode ends. (The default call <code class="docutils literal notranslate"><span class="pre">gym.wrapper.Monitor</span></code>implementation, depends on <code class="docutils literal notranslate"><span class="pre">ffmpeg</span></code>), the code shown below will run an environment episode and save the result of this episode in the form <code class="docutils literal notranslate"><span class="pre">./video/xxx.mp4</span></code>in a file like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">easydict</span> <span class="kn">import</span> <span class="n">EasyDict</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">dizoo.minigrid.envs</span> <span class="kn">import</span> <span class="n">MiniGridEnv</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">MiniGridEnv</span><span class="p">(</span><span class="n">EasyDict</span><span class="p">({</span><span class="s1">&#39;env_id&#39;</span><span class="p">:</span> <span class="s1">&#39;MiniGrid-Empty-8x8-v0&#39;</span><span class="p">,</span> <span class="s1">&#39;flat_obs&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}))</span>

<span class="n">env</span><span class="o">.</span><span class="n">enable_save_replay</span><span class="p">(</span><span class="n">replay_path</span><span class="o">=</span><span class="s1">&#39;./video&#39;</span><span class="p">)</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">act_val</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">info</span><span class="p">()</span><span class="o">.</span><span class="n">act_space</span><span class="o">.</span><span class="n">value</span>
    <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">=</span> <span class="n">act_val</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">],</span> <span class="n">act_val</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
    <span class="n">random_action</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))</span>
    <span class="n">timestep</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">random_action</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">timestep</span><span class="o">.</span><span class="n">done</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Episode is over, final eval reward is: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">timestep</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;final_eval_reward&#39;</span><span class="p">]))</span>
        <span class="k">break</span>
</pre></div>
</div>
</section>
</section>
<section id="di-zoo-runnable-code-example">
<h2>DI-zoo Runnable Code Example<a class="headerlink" href="#di-zoo-runnable-code-example" title="Permalink to this headline">¶</a></h2>
<p>The full training configuration file is at <a class="reference external" href="https://github.com/opendilab/DI-engine/tree/main/dizoo/minigrid/config">github
link</a>
The specific configuration files, such as <code class="docutils literal notranslate"><span class="pre">minigrid_r2d2_config.py</span></code>, use the following demo to run:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">easydict</span> <span class="kn">import</span> <span class="n">EasyDict</span>
<span class="kn">from</span> <span class="nn">ding.entry</span> <span class="kn">import</span> <span class="n">serial_pipeline</span>
<span class="n">collector_env_num</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">evaluator_env_num</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">minigrid_r2d2_config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">exp_name</span><span class="o">=</span><span class="s1">&#39;minigrid_empty8_r2d2_n5_bs2_ul40&#39;</span><span class="p">,</span>
    <span class="n">env</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">collector_env_num</span><span class="o">=</span><span class="n">collector_env_num</span><span class="p">,</span>
        <span class="n">evaluator_env_num</span><span class="o">=</span><span class="n">evaluator_env_num</span><span class="p">,</span>
        <span class="n">env_id</span><span class="o">=</span><span class="s1">&#39;MiniGrid-Empty-8x8-v0&#39;</span><span class="p">,</span>
        <span class="c1"># env_id=&#39;MiniGrid-FourRooms-v0&#39;,</span>
        <span class="c1"># env_id=&#39;MiniGrid-DoorKey-16x16-v0&#39;,</span>
        <span class="n">n_evaluator_episode</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">stop_value</span><span class="o">=</span><span class="mf">0.96</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">policy</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">cuda</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">on_policy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">priority</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">priority_IS_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">model</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">obs_shape</span><span class="o">=</span><span class="mi">2739</span><span class="p">,</span>
            <span class="n">action_shape</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
            <span class="n">encoder_hidden_size_list</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">512</span><span class="p">],</span>
        <span class="p">),</span>
        <span class="n">discount_factor</span><span class="o">=</span><span class="mf">0.997</span><span class="p">,</span>
        <span class="n">burnin_step</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="c1"># TODO(pu) 20</span>
        <span class="n">nstep</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="c1"># (int) the whole sequence length to unroll the RNN network minus</span>
        <span class="c1"># the timesteps of burnin part,</span>
        <span class="c1"># i.e., &lt;the whole sequence length&gt; = &lt;burnin_step&gt; + &lt;unroll_len&gt;</span>
        <span class="n">unroll_len</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="c1"># TODO(pu) 80</span>
        <span class="n">learn</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="c1"># according to the R2D2 paper, actor parameter update interval is 400</span>
            <span class="c1"># environment timesteps, and in per collect phase, we collect 32 sequence</span>
            <span class="c1"># samples, the length of each samlpe sequence is &lt;burnin_step&gt; + &lt;unroll_len&gt;,</span>
            <span class="c1"># which is 100 in our seeing, 32*100/400=8, so we set update_per_collect=8</span>
            <span class="c1"># in most environments</span>
            <span class="n">update_per_collect</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
            <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
            <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.0005</span><span class="p">,</span>
            <span class="n">target_update_theta</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">collect</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="c1"># NOTE it is important that don&#39;t include key n_sample here, to make sure self._traj_len=INF</span>
            <span class="n">each_iter_n_sample</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
            <span class="n">env_num</span><span class="o">=</span><span class="n">collector_env_num</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="nb">eval</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">env_num</span><span class="o">=</span><span class="n">evaluator_env_num</span><span class="p">,</span> <span class="p">),</span>
        <span class="n">other</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">eps</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;exp&#39;</span><span class="p">,</span>
                <span class="n">start</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
                <span class="n">end</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                <span class="n">decay</span><span class="o">=</span><span class="mf">1e5</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">replay_buffer</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">replay_buffer_size</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span>
                <span class="c1"># (Float type) How much prioritization is used: 0 means no prioritization while 1 means full prioritization</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
                <span class="c1"># (Float type) How much correction is used: 0 means no correction while 1 means full correction</span>
                <span class="n">beta</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">),</span>
    <span class="p">),</span>
<span class="p">)</span>
<span class="n">minigrid_r2d2_config</span> <span class="o">=</span> <span class="n">EasyDict</span><span class="p">(</span><span class="n">minigrid_r2d2_config</span><span class="p">)</span>
<span class="n">main_config</span><span class="o">=</span><span class="n">minigrid_r2d2_config</span>
<span class="n">minigrid_r2d2_create_config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">env</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;minigrid&#39;</span><span class="p">,</span>
        <span class="n">import_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dizoo.minigrid.envs.minigrid_env&#39;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="n">env_manager</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;base&#39;</span><span class="p">),</span>
    <span class="n">policy</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;r2d2&#39;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">minigrid_r2d2_create_config</span> <span class="o">=</span> <span class="n">EasyDict</span><span class="p">(</span><span class="n">minigrid_r2d2_create_config</span><span class="p">)</span>
<span class="n">create_config</span><span class="o">=</span><span class="n">minigrid_r2d2_create_config</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">serial_pipeline</span><span class="p">([</span><span class="n">main_config</span><span class="p">,</span> <span class="n">create_config</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="benchmark-algorithm-performance">
<h2>Benchmark Algorithm Performance<a class="headerlink" href="#benchmark-algorithm-performance" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>MiniGrid-Empty-8x8-v0 (under 0.5M env step, the average reward is greater than 0.95)</p>
<blockquote>
<div><ul class="simple">
<li><p>MiniGrid-Empty-8x8-v0+R2D2</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/empty8_r2d2.png"><img alt="../_images/empty8_r2d2.png" class="align-center" src="../_images/empty8_r2d2.png" style="width: 311.0px; height: 217.0px;" /></a>
</div></blockquote>
</li>
<li><p>MiniGrid-FourRooms-v0 (under 10M env step, the average reward is greater than 0.6)</p>
<blockquote>
<div><ul class="simple">
<li><p>MiniGrid-FourRooms-v0 + R2D2</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/fourrooms_r2d2.png"><img alt="../_images/fourrooms_r2d2.png" class="align-center" src="../_images/fourrooms_r2d2.png" style="width: 336.0px; height: 237.0px;" /></a>
</div></blockquote>
</li>
<li><p>MiniGrid-DoorKey-16x16-v0 (under 20M env step, the average reward is greater than 0.2)</p>
<blockquote>
<div><ul class="simple">
<li><p>MiniGrid-DoorKey-16x16-v0 + R2D2</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/doorkey_r2d2.png"><img alt="../_images/doorkey_r2d2.png" class="align-center" src="../_images/doorkey_r2d2.png" style="width: 338.0px; height: 236.0px;" /></a>
</div></blockquote>
</li>
</ul>
</section>
</section>


              </article>
              
            </div>
            <footer>
  
  <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
    
    <a href="slime_volleyball.html" class="btn btn-neutral float-right" title="Slime Volleyball" accesskey="n"
      rel="next">Next <img src="../_static/images/chevron-right-blue.svg"
        class="next-page"></a>
    
    
    <a href="bipedalwalker.html" class="btn btn-neutral" title="BipedalWalker" accesskey="p"
      rel="prev"><img src="../_static/images/chevron-right-blue.svg" class="previous-page"> Previous</a>
    
  </div>
  

  <hr>

  <div role="contentinfo">
    <p>
      &copy; Copyright 2021, OpenDILab Contributors.

    </p>
  </div>
  
  <div>
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a
      href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the
      Docs</a>.
  </div>
   

</footer>
          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">MiniGrid</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#install">Install</a><ul>
<li><a class="reference internal" href="#installation-method">Installation Method</a></li>
<li><a class="reference internal" href="#verify-installation">Verify Installation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#space-before-transformation-original-environment">Space before Transformation (Original Environment)</a><ul>
<li><a class="reference internal" href="#observation-space">Observation Space</a></li>
<li><a class="reference internal" href="#action-space">Action Space</a></li>
<li><a class="reference internal" href="#bonus-space">Bonus Space</a></li>
<li><a class="reference internal" href="#other">Other</a></li>
</ul>
</li>
<li><a class="reference internal" href="#key-facts">Key Facts</a></li>
<li><a class="reference internal" href="#transformed-space-rl-environment">Transformed Space (RL environment)</a><ul>
<li><a class="reference internal" href="#id1">Observation Space</a></li>
<li><a class="reference internal" href="#id2">Action Space</a></li>
<li><a class="reference internal" href="#id3">Bonus Space</a></li>
<li><a class="reference internal" href="#id4">Other</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id5">Other</a><ul>
<li><a class="reference internal" href="#random-seed">Random Seed</a></li>
<li><a class="reference internal" href="#the-difference-between-training-and-testing-environments">The difference between training and testing environments</a></li>
<li><a class="reference internal" href="#store-video">Store Video</a></li>
</ul>
</li>
<li><a class="reference internal" href="#di-zoo-runnable-code-example">DI-zoo Runnable Code Example</a></li>
<li><a class="reference internal" href="#benchmark-algorithm-performance">Benchmark Algorithm Performance</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
    </section>
  </div>

  


  

  
  <script type="text/javascript" id="documentation_options" data-url_root="../"
    src="../_static/documentation_options.js"></script>
  <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
  <script src="../_static/jquery.js"></script>
  <script src="../_static/underscore.js"></script>
  <script src="../_static/doctools.js"></script>
  

  

  <script type="text/javascript" src="../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
  </div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://di-engine-docs.readthedocs.io/en/latest/" aria-label="OpenMMLab"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://github.com/opendilab/DI-engine" target="_blank">GitHub</a>
          </li>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function () {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function (e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>

</html>