


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Slime Volleyball &mdash; DI-engine 0.1.0 documentation</title>
  

  <link rel="shortcut icon" href="../_static/images/favicon.ico" />
  
  

  

  
  
  

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/style.css" type="text/css" />
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="next" title="Procgen" href="procgen.html" />
  <link rel="prev" title="MiniGrid" href="minigrid.html" />
    <link href="../_static/css/style.css" rel="stylesheet" type="text/css">


  
  <script src="../_static/js/modernizr.min.js"></script>
  <script>
    MathJax = {
        chtml: {
            scale: 1,
            minScale: 1,
        },
        svg: {
            scale: 1,
            minScale: 1,
        }
    }
</script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"
    integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://di-engine-docs.readthedocs.io/en/latest/"
        aria-label="OpenMMLab"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://github.com/opendilab/DI-engine" target="_blank">GitHub</a>
          </li>
          <li >
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a
                class="resource-option with-down-arrow">
                OpenDILab
              </a>
              <div class="resources-dropdown-menu">
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/DI-engine" target="_blank">
                  <span class="dropdown-title">DI-engine </span>
                  <p>OpenDILab Decision AI Engine</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/DI-star" target="_blank">
                  <span class="dropdown-title">DI-star </span>
                  <p>OpenDILab Decision AI in StarCraftII</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/DI-drive" target="_blank">
                  <span class="dropdown-title">DI-drive </span>
                  <p>OpenDILab Auto-driving platform</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/GoBigger" target="_blank">
                  <span class="dropdown-title">GoBigger </span>
                  <p>OpenDILab Multi-Agent Environment</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/DI-smartcross" target="_blank">
                  <span class="dropdown-title">DI-smartcross </span>
                  <p>Decision Intelligence Platform for Traffic Crossing Signal Control</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/DI-treetensor" target="_blank">
                  <span class="dropdown-title">DI-treetensor </span>
                  <p>Tree Nested PyTorch Tensor Lib</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/DI-sheep" target="_blank">
                  <span class="dropdown-title">DI-sheep </span>
                  <p>Deep Reinforcement Learning + 3 Tiles Game</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/awesome-model-based-RL" target="_blank">
                  <span class="dropdown-title">awesome-model-based-RL </span>
                  <p>A curated list of awesome model based RL resources (continually updated)</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/awesome-decision-transformer" target="_blank">
                  <span class="dropdown-title">awesome-decision-transformer </span>
                  <p>A curated list of Decision Transformer resources (continually updated)</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/awesome-exploration-rl" target="_blank">
                  <span class="dropdown-title">awesome-exploration-rl </span>
                  <p>A curated list of awesome exploration RL resources (continually updated)</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/awesome-multi-modal-reinforcement-learning" target="_blank">
                  <span class="dropdown-title">awesome-multi-modal-reinforcement-learning </span>
                  <p>A curated list of Multi-Modal Reinforcement Learning resources (continually updated)</p>
                </a>
              </div>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>
  </div>
</div>

<body class="pytorch-body">

   

  

  <div class="table-of-contents-link-wrapper">
    <span>Table of Contents</span>
    <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
  </div>

  <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
    <div class="pytorch-side-scroll">
      <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <div class="pytorch-left-menu-search">
          

          
          
          
          

          



<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        
        
        
        
        
        <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../00_intro/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_quickstart/index.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_algo/index.html">RL Algorithm Taxonomy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_system/index.html">System Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_best_practice/index.html">Best Practice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_api_doc/index.html">API Doc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06_faq/index.html">FAQ</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reinforcement Learning Tutorial</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../10_concepts/index.html">Introduction to RL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11_dizoo/index.html">Learn From DI-zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../12_policies/index.html">RL Algorithms Cheat Sheet</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">RL Env Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Specification</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../20_spec/index.html">Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../21_code_style/index.html">Code Style Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../22_test/index.html">Unit Test Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../23_visual/index.html">Diagrams and Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../24_cooperation/index.html">Github Cooperation</a></li>
</ul>

        
        
      </div>
    </div>
  </nav>

  <div class="pytorch-container">
    <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
      <div class="pytorch-breadcrumbs-wrapper">
        















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../index.html">
            Docs
        </a> &gt;
      </li>

        
          <li><a href="index.html">RL Env Examples</a> &gt;</li>
        
      <li>Slime Volleyball</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="../_sources/13_envs/slime_volleyball.rst.txt" rel="nofollow"><img src="../_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
      </div>

      <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
        Shortcuts
      </div>
    </div>

    <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
      <div class="pytorch-content-left">
        
          <div class="rst-content">
            
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
              <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
                
  <section id="slime-volleyball">
<h1>Slime Volleyball<a class="headerlink" href="#slime-volleyball" title="Permalink to this headline">¶</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Slime Volleyball is a two-player match-based environment with two types of observation spaces, vector and picture forms. The action space is often simplified to a discrete action space, used as the basic environment for testing <code class="docutils literal notranslate"><span class="pre">self-play</span></code>-related algorithms. It is a collection of environments (there are 3 sub-environments, namely <code class="docutils literal notranslate"><span class="pre">SlimeVolley-v0</span></code>, <code class="docutils literal notranslate"><span class="pre">SlimeVolleyPixel-v0</span></code>, <code class="docutils literal notranslate"><span class="pre">SlimeVolleyNoFrameskip-v0</span></code>), of which the <code class="docutils literal notranslate"><span class="pre">SlimeVolley-v0</span></code> game is shown in the figure below.</p>
<img alt="../_images/slime_volleyball.gif" class="align-center" src="../_images/slime_volleyball.gif" />
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<section id="installation-methods">
<h3>Installation Methods<a class="headerlink" href="#installation-methods" title="Permalink to this headline">¶</a></h3>
<p>Install <code class="docutils literal notranslate"><span class="pre">slimevolleygym</span></code>. You can install by command <code class="docutils literal notranslate"><span class="pre">pip</span></code> or through <strong>DI-engine</strong>.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1"># Method1: Install Directly</span>
pip install slimevolleygym
</pre></div>
</div>
</section>
<section id="installation-check">
<h3>Installation Check<a class="headerlink" href="#installation-check" title="Permalink to this headline">¶</a></h3>
<p>After completing installation, you can check whether it is succesful by the following commands:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gym</span>
<span class="kn">import</span> <span class="nn">slimevolleygym</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;SlimeVolley-v0&quot;</span><span class="p">)</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obs</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (12, )</span>
</pre></div>
</div>
</section>
<section id="di-engine-mirrors">
<h3>DI-engine Mirrors<a class="headerlink" href="#di-engine-mirrors" title="Permalink to this headline">¶</a></h3>
<p>Due to Slime Volleyball is easy to install, DI-engine does not have Mirror specifically for it. You can customize your build with the benchmark Mirror <code class="docutils literal notranslate"><span class="pre">opendilab/ding:nightly</span></code>, or visit the <a class="reference external" href="https://hub.docker.com/r/opendilab/ding">docker
hub</a> for more mirrors.</p>
</section>
</section>
<section id="original-environment">
<h2>Original Environment<a class="headerlink" href="#original-environment" title="Permalink to this headline">¶</a></h2>
<p>Note: SlimeVolley-v0 is used here as an example, because benchmarking the self-play series of algorithms naturally gives priority to simplicity. If you want to use the other two environments, you can check the original repository and adapt the environment according to the <a class="reference external" href="https://di-engine-docs.readthedocs.io/en/main-zh/feature/env_overview.html">DI-engine’s API</a>.</p>
<section id="observation-space">
<h3>Observation Space<a class="headerlink" href="#observation-space" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>The observation space is a vector of size <code class="docutils literal notranslate"><span class="pre">(12,</span> <span class="pre">)</span></code> containing the absolute coordinates of self, opponent, and ball with two consecutive frames stitched togerther. The data type is <code class="docutils literal notranslate"><span class="pre">float64</span></code>
i.e. (x_agent, y_agent, x_agent_next, y_agent_next, x_ball, y_ball, x_ball_next, y_ball_next, x_opponent, y_opponent, x_opponent_next, y_opponent_next)</p></li>
</ul>
</section>
<section id="action-space">
<h3>Action Space<a class="headerlink" href="#action-space" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>The original action space of <code class="docutils literal notranslate"><span class="pre">SlimeVolley-v0</span></code> is defined as <code class="docutils literal notranslate"><span class="pre">MultiBinary(3)</span></code> with three kinds of actions. More than one actions can be performed at the same time. Each action is corresponding to two cases: 0 (not executed) and 1 (executed).
i.e. <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">0,</span> <span class="pre">1)</span></code> represents the execution of the first and third actions at the same time. The data type is <code class="docutils literal notranslate"><span class="pre">int</span></code>, which needs to be passed into a python list object (or a 1-dimensional np array of size 3, i.e. <code class="docutils literal notranslate"><span class="pre">np.array([0,</span> <span class="pre">1,</span> <span class="pre">0])</span></code></p></li>
<li><p>The actual implementation does not strictly limit the action to 0 and 1. It treats values greater than 0 as 1, while values less than or equal to 0 as 0.</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">SlimeVolley-v0</span></code> environment, the basic action is meant to be</p>
<blockquote>
<div><ul class="simple">
<li><p>0: forward (forward)</p></li>
<li><p>1: backward (backward)</p></li>
<li><p>2: jump (jump)</p></li>
</ul>
</div></blockquote>
</li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">SlimeVolley-v0</span></code> environment, the combined action is meant to be</p>
<blockquote>
<div><ul class="simple">
<li><p>[0, 0, 0],  NOOP</p></li>
<li><p>[1, 0, 0],  LEFT (forward)</p></li>
<li><p>[1, 0, 1],  UPLEFT (forward jump)</p></li>
<li><p>[0, 0, 1],  UP (jump)</p></li>
<li><p>[0, 1, 1],  UPRIGHT (backward jump)</p></li>
<li><p>[0, 1, 0],  RIGHT (backward)</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
<section id="reward-space">
<h3>Reward Space<a class="headerlink" href="#reward-space" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>The reward is the score of the game. If the ball lands on the ground of your field, -1 is given. If it lands on the ground of the opponent‘s field, +1 is given. If the game is still in progress, 0 is given.</p></li>
</ul>
</section>
<section id="other">
<h3>Other<a class="headerlink" href="#other" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>The end of the game is represented as the end of episode. There are two ending conditions</p>
<ul>
<li><ol class="arabic simple">
<li><p>The life point of one side is 0, default is 5.</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="2">
<li><p>reach the maximum environmental step, default is 3000.</p></li>
</ol>
</li>
</ul>
</li>
<li><p>The game supports two kinds of matchmaking, intelligent body against built-in bot (the bot left, the intelligent body right), intelligent body against intelligent body</p></li>
<li><p>The built-in bot is a very simple RNN-trained smartbody <a class="reference external" href="https://blog.otoro.net/2015/03/28/neural-slime-volleyball/">bot_link</a></p></li>
<li><p>Only one side’s obs are returned by default. The other side’s obs, and information can be found in the <code class="docutils literal notranslate"><span class="pre">info</span></code> field</p></li>
</ul>
</section>
</section>
<section id="key-facts">
<h2>Key Facts<a class="headerlink" href="#key-facts" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>1-dimensional vector observation space (of size (12, )) with information in absolute coordinates</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MultiBinary</span></code> action space</p></li>
<li><p>sparser rewards (maximum life value of 5, maximum number of steps of 3,000, the reward can be gain only when the life value is deducted)</p></li>
</ol>
</section>
<section id="rl-environment-space">
<h2>RL Environment Space<a class="headerlink" href="#rl-environment-space" title="Permalink to this headline">¶</a></h2>
<section id="id1">
<h3>Observation Space<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Transform the space vector into a one-dimensional np array of size <code class="docutils literal notranslate"><span class="pre">(12,</span> <span class="pre">)</span></code>. The data type is <code class="docutils literal notranslate"><span class="pre">np.float32</span></code>.</p></li>
</ul>
</section>
<section id="id2">
<h3>Action Space<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Transform the <code class="docutils literal notranslate"><span class="pre">MultiBinary</span></code> action space into a discrete action space of size 6 (a simple Cartesian product is sufficient). The final result is a one-dimensional np array of size <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">)</span></code>. The data type is <code class="docutils literal notranslate"><span class="pre">np.int64</span></code></p></li>
</ul>
</section>
<section id="id3">
<h3>Reward Space<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Transform the reward vector into a one-dimensional np array of size<code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">)</span></code>. The data type is<code class="docutils literal notranslate"><span class="pre">np.float32</span></code>values in <code class="docutils literal notranslate"><span class="pre">[-1,</span> <span class="pre">0,</span> <span class="pre">1]</span></code>.</p></li>
</ul>
<p>Using Slime Volleyball in ‘OpenAI Gym’ format:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gym</span>

<span class="n">obs_space</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">low</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">act_space</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">rew_space</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">low</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id4">
<h3>Other<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>The<cite>info`</cite>returned form the environment<code class="docutils literal notranslate"><span class="pre">step</span></code>must contain the<code class="docutils literal notranslate"><span class="pre">eval_episode_return</span></code>key-value pair, which represents the evaluation metrics for the entire episode, containing the rewards for the episode (life value difference between two players).</p></li>
<li><p>The above spatial definitions are all descriptions of single intelligences. The multi-intelligence space splices the corresponding obs/action/reward information.</p></li>
</ul>
<p>i.e. The observation space changes from <code class="docutils literal notranslate"><span class="pre">(12,</span> <span class="pre">)</span></code> to <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">12)</span></code>, thar represents the observation information of both sides.</p>
</section>
</section>
<section id="id5">
<h2>Other<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<section id="lazy-initialization">
<h3>Lazy initialization<a class="headerlink" href="#lazy-initialization" title="Permalink to this headline">¶</a></h3>
<p>In order to support environment vetorization, an environment instance is oftern initialized lazily. In this way, method <code class="docutils literal notranslate"><span class="pre">__init__</span></code> does not really initialize the real original environment, but only set corresponding parameters and configurations. The real original environment is initialized when first calling mdthod <code class="docutils literal notranslate"><span class="pre">reset</span></code>.</p>
</section>
<section id="random-seed">
<h3>Random Seed<a class="headerlink" href="#random-seed" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>There are two random seeds in the environment. One is orignal environment’s random seed; The other is the random seed which is required in many environment space transformations. (e.g. <code class="docutils literal notranslate"><span class="pre">random</span></code>, <code class="docutils literal notranslate"><span class="pre">np.random</span></code>)</p></li>
<li><p>As a user, you only need to set these two random seeds by calling method <code class="docutils literal notranslate"><span class="pre">seed</span></code>, and do not need to care about the implementation details.</p></li>
<li><p>Implementation details: For orignal environment’s random seed, within RL env’s <code class="docutils literal notranslate"><span class="pre">reset</span></code> method; Before orginal env’s <code class="docutils literal notranslate"><span class="pre">reset</span></code> method.</p></li>
<li><p>Implementation details: For the seed for <code class="docutils literal notranslate"><span class="pre">random</span></code> / <code class="docutils literal notranslate"><span class="pre">np.random</span></code>, within env’s <code class="docutils literal notranslate"><span class="pre">seed</span></code> method.</p></li>
</ul>
</section>
<section id="difference-between-training-env-and-evaluation-env">
<h3>Difference between training env and evaluation env<a class="headerlink" href="#difference-between-training-env-and-evaluation-env" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Training env uses dynamic random seed, i.e. Every episode has different random seeds generated by one random generator. However, this random generator’s random seed is set by env’s <code class="docutils literal notranslate"><span class="pre">seed</span></code> method, and is fixed throughout an experiment. Evaluation env uses static random seed, i.e. Every episode has the same random seed, which is set directly by <code class="docutils literal notranslate"><span class="pre">seed</span></code> method.</p></li>
<li><p>Training env and evaluation env use different pre-process wrappers. <code class="docutils literal notranslate"><span class="pre">episode_life</span></code> and <code class="docutils literal notranslate"><span class="pre">clip_reward</span></code> are not used in evaluation env.</p></li>
</ul>
</section>
<section id="save-the-replay-video">
<h3>Save the replay video<a class="headerlink" href="#save-the-replay-video" title="Permalink to this headline">¶</a></h3>
<p>After env is initiated, and before it is reset, call <code class="docutils literal notranslate"><span class="pre">enable_save_replay</span></code> method to set where the replay video will be saved. Environment will automatically save the replay video after each episode is completed. (The default call is <code class="docutils literal notranslate"><span class="pre">gym.wrappers.RecordVideo</span></code>). The code shown below will run an environment episode and save the replay viedo in a folder <code class="docutils literal notranslate"><span class="pre">./video/</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">easydict</span> <span class="kn">import</span> <span class="n">EasyDict</span>
<span class="kn">from</span> <span class="nn">dizoo.slime_volley.envs.slime_volley_env</span> <span class="kn">import</span> <span class="n">SlimeVolleyEnv</span>

<span class="n">env</span> <span class="o">=</span> <span class="n">SlimeVolleyEnv</span><span class="p">(</span><span class="n">EasyDict</span><span class="p">({</span><span class="s1">&#39;env_id&#39;</span><span class="p">:</span> <span class="s1">&#39;SlimeVolley-v0&#39;</span><span class="p">,</span> <span class="s1">&#39;agent_vs_agent&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}))</span>
<span class="n">env</span><span class="o">.</span><span class="n">enable_save_replay</span><span class="p">(</span><span class="n">replay_path</span><span class="o">=</span><span class="s1">&#39;./video&#39;</span><span class="p">)</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">action</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">random_action</span><span class="p">()</span>
    <span class="n">timestep</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">timestep</span><span class="o">.</span><span class="n">done</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Episode is over, eval episode return is: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">timestep</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;eval_episode_return&#39;</span><span class="p">]))</span>
        <span class="k">break</span>
</pre></div>
</div>
</section>
</section>
<section id="di-zoo-runnable-code">
<h2>DI-zoo runnable code<a class="headerlink" href="#di-zoo-runnable-code" title="Permalink to this headline">¶</a></h2>
<p>Complete training configuration can be found on <a class="reference external" href="https://github.com/opendilab/DI-engine/tree/main/dizoo/slime_volley/entry">github
link</a>.
For specific configuration file, e.g. <code class="docutils literal notranslate"><span class="pre">slime_volley_selfplay_ppo_main.py</span></code>, you can run the demo as shown below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">gym</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">tensorboardX</span> <span class="kn">import</span> <span class="n">SummaryWriter</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>

<span class="kn">from</span> <span class="nn">ding.config</span> <span class="kn">import</span> <span class="n">compile_config</span>
<span class="kn">from</span> <span class="nn">ding.worker</span> <span class="kn">import</span> <span class="n">BaseLearner</span><span class="p">,</span> <span class="n">BattleSampleSerialCollector</span><span class="p">,</span> <span class="n">NaiveReplayBuffer</span><span class="p">,</span> <span class="n">InteractionSerialEvaluator</span>
<span class="kn">from</span> <span class="nn">ding.envs</span> <span class="kn">import</span> <span class="n">SyncSubprocessEnvManager</span>
<span class="kn">from</span> <span class="nn">ding.policy</span> <span class="kn">import</span> <span class="n">PPOPolicy</span>
<span class="kn">from</span> <span class="nn">ding.model</span> <span class="kn">import</span> <span class="n">VAC</span>
<span class="kn">from</span> <span class="nn">ding.utils</span> <span class="kn">import</span> <span class="n">set_pkg_seed</span>
<span class="kn">from</span> <span class="nn">dizoo.slime_volley.envs</span> <span class="kn">import</span> <span class="n">SlimeVolleyEnv</span>
<span class="kn">from</span> <span class="nn">dizoo.slime_volley.config.slime_volley_ppo_config</span> <span class="kn">import</span> <span class="n">main_config</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_iterations</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e10</span><span class="p">)):</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">compile_config</span><span class="p">(</span>
        <span class="n">cfg</span><span class="p">,</span>
        <span class="n">SyncSubprocessEnvManager</span><span class="p">,</span>
        <span class="n">PPOPolicy</span><span class="p">,</span>
        <span class="n">BaseLearner</span><span class="p">,</span>
        <span class="n">BattleSampleSerialCollector</span><span class="p">,</span>
        <span class="n">InteractionSerialEvaluator</span><span class="p">,</span>
        <span class="n">NaiveReplayBuffer</span><span class="p">,</span>
        <span class="n">save_cfg</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">collector_env_num</span><span class="p">,</span> <span class="n">evaluator_env_num</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">collector_env_num</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">evaluator_env_num</span>
    <span class="n">collector_env_cfg</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">env</span><span class="p">)</span>
    <span class="n">collector_env_cfg</span><span class="o">.</span><span class="n">agent_vs_agent</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">evaluator_env_cfg</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">env</span><span class="p">)</span>
    <span class="n">evaluator_env_cfg</span><span class="o">.</span><span class="n">agent_vs_agent</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">collector_env</span> <span class="o">=</span> <span class="n">SyncSubprocessEnvManager</span><span class="p">(</span>
        <span class="n">env_fn</span><span class="o">=</span><span class="p">[</span><span class="n">partial</span><span class="p">(</span><span class="n">SlimeVolleyEnv</span><span class="p">,</span> <span class="n">collector_env_cfg</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">collector_env_num</span><span class="p">)],</span> <span class="n">cfg</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">manager</span>
    <span class="p">)</span>
    <span class="n">evaluator_env</span> <span class="o">=</span> <span class="n">SyncSubprocessEnvManager</span><span class="p">(</span>
        <span class="n">env_fn</span><span class="o">=</span><span class="p">[</span><span class="n">partial</span><span class="p">(</span><span class="n">SlimeVolleyEnv</span><span class="p">,</span> <span class="n">evaluator_env_cfg</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">evaluator_env_num</span><span class="p">)],</span> <span class="n">cfg</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">manager</span>
    <span class="p">)</span>

    <span class="n">collector_env</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">evaluator_env</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="n">dynamic_seed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">set_pkg_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="n">use_cuda</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">cuda</span><span class="p">)</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">VAC</span><span class="p">(</span><span class="o">**</span><span class="n">cfg</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">model</span><span class="p">)</span>
    <span class="n">policy</span> <span class="o">=</span> <span class="n">PPOPolicy</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">policy</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>

    <span class="n">tb_logger</span> <span class="o">=</span> <span class="n">SummaryWriter</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;./</span><span class="si">{}</span><span class="s1">/log/&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">exp_name</span><span class="p">),</span> <span class="s1">&#39;serial&#39;</span><span class="p">))</span>
    <span class="n">learner</span> <span class="o">=</span> <span class="n">BaseLearner</span><span class="p">(</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">learn</span><span class="o">.</span><span class="n">learner</span><span class="p">,</span> <span class="n">policy</span><span class="o">.</span><span class="n">learn_mode</span><span class="p">,</span> <span class="n">tb_logger</span><span class="p">,</span> <span class="n">exp_name</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">exp_name</span><span class="p">,</span> <span class="n">instance_name</span><span class="o">=</span><span class="s1">&#39;learner1&#39;</span>
    <span class="p">)</span>
    <span class="n">collector</span> <span class="o">=</span> <span class="n">BattleSampleSerialCollector</span><span class="p">(</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">collect</span><span class="o">.</span><span class="n">collector</span><span class="p">,</span>
        <span class="n">collector_env</span><span class="p">,</span> <span class="p">[</span><span class="n">policy</span><span class="o">.</span><span class="n">collect_mode</span><span class="p">,</span> <span class="n">policy</span><span class="o">.</span><span class="n">collect_mode</span><span class="p">],</span>
        <span class="n">tb_logger</span><span class="p">,</span>
        <span class="n">exp_name</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">exp_name</span>
    <span class="p">)</span>
    <span class="n">evaluator_cfg</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">eval</span><span class="o">.</span><span class="n">evaluator</span><span class="p">)</span>
    <span class="n">evaluator_cfg</span><span class="o">.</span><span class="n">stop_value</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">stop_value</span>
    <span class="n">evaluator</span> <span class="o">=</span> <span class="n">InteractionSerialEvaluator</span><span class="p">(</span>
        <span class="n">evaluator_cfg</span><span class="p">,</span>
        <span class="n">evaluator_env</span><span class="p">,</span>
        <span class="n">policy</span><span class="o">.</span><span class="n">eval_mode</span><span class="p">,</span>
        <span class="n">tb_logger</span><span class="p">,</span>
        <span class="n">exp_name</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">exp_name</span><span class="p">,</span>
        <span class="n">instance_name</span><span class="o">=</span><span class="s1">&#39;builtin_ai_evaluator&#39;</span>
    <span class="p">)</span>

    <span class="n">learner</span><span class="o">.</span><span class="n">call_hook</span><span class="p">(</span><span class="s1">&#39;before_run&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_iterations</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">should_eval</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">train_iter</span><span class="p">):</span>
            <span class="n">stop_flag</span><span class="p">,</span> <span class="n">reward</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">save_checkpoint</span><span class="p">,</span> <span class="n">learner</span><span class="o">.</span><span class="n">train_iter</span><span class="p">,</span> <span class="n">collector</span><span class="o">.</span><span class="n">envstep</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">stop_flag</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="n">new_data</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">collector</span><span class="o">.</span><span class="n">collect</span><span class="p">(</span><span class="n">train_iter</span><span class="o">=</span><span class="n">learner</span><span class="o">.</span><span class="n">train_iter</span><span class="p">)</span>
        <span class="n">train_data</span> <span class="o">=</span> <span class="n">new_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">new_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">learner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">collector</span><span class="o">.</span><span class="n">envstep</span><span class="p">)</span>
    <span class="n">learner</span><span class="o">.</span><span class="n">call_hook</span><span class="p">(</span><span class="s1">&#39;after_run&#39;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">(</span><span class="n">main_config</span><span class="p">)</span>
</pre></div>
</div>
<p>Note: To run the intelligent body against built-in bot mode, python <code class="docutils literal notranslate"><span class="pre">slime_volley_ppo_config.py</span></code>.</p>
<p>Note: For some specific algorithm, use the corresponding specific entry function.</p>
</section>
<section id="algorithm-benchmark">
<h2>Algorithm Benchmark<a class="headerlink" href="#algorithm-benchmark" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>SlimeVolley-v0（Average reward greater than 1 is considered as good agent with the build-in bot）</p>
<ul class="simple">
<li><p>SlimeVolley-v0 + PPO + vs Bot</p></li>
</ul>
<img alt="../_images/slime_volleyball_ppo_vsbot.png" class="align-center" src="../_images/slime_volleyball_ppo_vsbot.png" />
<ul class="simple">
<li><p>SlimeVolley-v0 + PPO + self-play</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/slime_volleyball_ppo_selfplay.png"><img alt="../_images/slime_volleyball_ppo_selfplay.png" class="align-center" src="../_images/slime_volleyball_ppo_selfplay.png" style="width: 478.79999999999995px; height: 347.2px;" /></a>
</li>
</ul>
</section>
</section>


              </article>
              
            </div>
            <footer>
  
  <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
    
    <a href="procgen.html" class="btn btn-neutral float-right" title="Procgen" accesskey="n"
      rel="next">Next <img src="../_static/images/chevron-right-blue.svg"
        class="next-page"></a>
    
    
    <a href="minigrid.html" class="btn btn-neutral" title="MiniGrid" accesskey="p"
      rel="prev"><img src="../_static/images/chevron-right-blue.svg" class="previous-page"> Previous</a>
    
  </div>
  

  <hr>

  <div role="contentinfo">
    <p>
      &copy; Copyright 2021, OpenDILab Contributors.

    </p>
  </div>
  
  <div>
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a
      href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the
      Docs</a>.
  </div>
   

</footer>
          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">Slime Volleyball</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#installation">Installation</a><ul>
<li><a class="reference internal" href="#installation-methods">Installation Methods</a></li>
<li><a class="reference internal" href="#installation-check">Installation Check</a></li>
<li><a class="reference internal" href="#di-engine-mirrors">DI-engine Mirrors</a></li>
</ul>
</li>
<li><a class="reference internal" href="#original-environment">Original Environment</a><ul>
<li><a class="reference internal" href="#observation-space">Observation Space</a></li>
<li><a class="reference internal" href="#action-space">Action Space</a></li>
<li><a class="reference internal" href="#reward-space">Reward Space</a></li>
<li><a class="reference internal" href="#other">Other</a></li>
</ul>
</li>
<li><a class="reference internal" href="#key-facts">Key Facts</a></li>
<li><a class="reference internal" href="#rl-environment-space">RL Environment Space</a><ul>
<li><a class="reference internal" href="#id1">Observation Space</a></li>
<li><a class="reference internal" href="#id2">Action Space</a></li>
<li><a class="reference internal" href="#id3">Reward Space</a></li>
<li><a class="reference internal" href="#id4">Other</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id5">Other</a><ul>
<li><a class="reference internal" href="#lazy-initialization">Lazy initialization</a></li>
<li><a class="reference internal" href="#random-seed">Random Seed</a></li>
<li><a class="reference internal" href="#difference-between-training-env-and-evaluation-env">Difference between training env and evaluation env</a></li>
<li><a class="reference internal" href="#save-the-replay-video">Save the replay video</a></li>
</ul>
</li>
<li><a class="reference internal" href="#di-zoo-runnable-code">DI-zoo runnable code</a></li>
<li><a class="reference internal" href="#algorithm-benchmark">Algorithm Benchmark</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
    </section>
  </div>

  


  

  
  <script type="text/javascript" id="documentation_options" data-url_root="../"
    src="../_static/documentation_options.js"></script>
  <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
  <script src="../_static/jquery.js"></script>
  <script src="../_static/underscore.js"></script>
  <script src="../_static/doctools.js"></script>
  

  

  <script type="text/javascript" src="../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
  </div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://di-engine-docs.readthedocs.io/en/latest/" aria-label="OpenMMLab"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://github.com/opendilab/DI-engine" target="_blank">GitHub</a>
          </li>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function () {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function (e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>

</html>