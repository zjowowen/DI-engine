


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>dmc2gym &mdash; DI-engine 0.1.0 documentation</title>
  

  <link rel="shortcut icon" href="../_static/images/favicon.ico" />
  
  

  

  
  
  

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/style.css" type="text/css" />
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="next" title="gym hybrid" href="gym_hybrid.html" />
  <link rel="prev" title="PettingZoo" href="pettingzoo.html" />
    <link href="../_static/css/style.css" rel="stylesheet" type="text/css">


  
  <script src="../_static/js/modernizr.min.js"></script>
  <script>
    MathJax = {
        chtml: {
            scale: 1,
            minScale: 1,
        },
        svg: {
            scale: 1,
            minScale: 1,
        }
    }
</script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"
    integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://di-engine-docs.readthedocs.io/en/latest/"
        aria-label="OpenMMLab"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://github.com/opendilab/DI-engine" target="_blank">GitHub</a>
          </li>
          <li >
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a
                class="resource-option with-down-arrow">
                OpenDILab
              </a>
              <div class="resources-dropdown-menu">
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/DI-engine" target="_blank">
                  <span class="dropdown-title">DI-engine </span>
                  <p>OpenDILab Decision AI Engine</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/DI-star" target="_blank">
                  <span class="dropdown-title">DI-star </span>
                  <p>OpenDILab Decision AI in StarCraftII</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/DI-drive" target="_blank">
                  <span class="dropdown-title">DI-drive </span>
                  <p>OpenDILab Auto-driving platform</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/GoBigger" target="_blank">
                  <span class="dropdown-title">GoBigger </span>
                  <p>OpenDILab Multi-Agent Environment</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/DI-smartcross" target="_blank">
                  <span class="dropdown-title">DI-smartcross </span>
                  <p>Decision Intelligence Platform for Traffic Crossing Signal Control</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/DI-treetensor" target="_blank">
                  <span class="dropdown-title">DI-treetensor </span>
                  <p>Tree Nested PyTorch Tensor Lib</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/awesome-model-based-RL" target="_blank">
                  <span class="dropdown-title">awesome-model-based-RL </span>
                  <p>A curated list of awesome model based RL resources (continually updated)</p>
                </a>
              </div>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>
  </div>
</div>

<body class="pytorch-body">

   

  

  <div class="table-of-contents-link-wrapper">
    <span>Table of Contents</span>
    <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
  </div>

  <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
    <div class="pytorch-side-scroll">
      <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <div class="pytorch-left-menu-search">
          

          
          
          
          

          



<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        
        
        
        
        
        <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../00_intro/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_quickstart/index.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_algo/index.html">RL Algorithm Taxonomy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_system/index.html">System Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_best_practice/index.html">Best Practice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_api_doc/index.html">API Doc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06_faq/index.html">FAQ</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reinforcement Learning Tutorial</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../10_concepts/index.html">Introduction to RL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11_dizoo/index.html">Learn From DI-zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../12_policies/index.html">RL Algorithms Cheat Sheet</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">RL Env Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Specification</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../20_spec/index.html">Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../21_code_style/index.html">Code Style Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../22_test/index.html">Unit Test Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../23_visual/index.html">Diagrams and Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../24_cooperation/index.html">Github Cooperation</a></li>
</ul>

        
        
      </div>
    </div>
  </nav>

  <div class="pytorch-container">
    <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
      <div class="pytorch-breadcrumbs-wrapper">
        















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../index.html">
            Docs
        </a> &gt;
      </li>

        
          <li><a href="index.html">RL Env Examples</a> &gt;</li>
        
      <li>dmc2gym</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="../_sources/13_envs/dmc2gym.rst.txt" rel="nofollow"><img src="../_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
      </div>

      <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
        Shortcuts
      </div>
    </div>

    <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
      <div class="pytorch-content-left">
        
          <div class="rst-content">
            
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
              <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
                
  <section id="dmc2gym">
<h1>dmc2gym<a class="headerlink" href="#dmc2gym" title="Permalink to this headline">¶</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>dmc2gym is a light wrapper for <a class="reference external" href="https://github.com/deepmind/dm_control">DeepMind Control Suite</a> , providing standard OpenAI Gym interface.
DeepMind Control Suite is a set of continuous control tasks with standardized structures and interpretable rewards intended as a performance benchmark for reinforcement learning agents.</p>
<img alt="../_images/dmc2gym.png" class="align-center" src="../_images/dmc2gym.png" />
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<section id="method">
<h3>Method<a class="headerlink" href="#method" title="Permalink to this headline">¶</a></h3>
<p>\ <code class="docutils literal notranslate"><span class="pre">gym</span></code>\ , \ <code class="docutils literal notranslate"><span class="pre">dm_control</span></code> \ and \ <code class="docutils literal notranslate"><span class="pre">dmc2gym</span></code> \ are required to be installed, and users could install from PyPI with the following command: (Please kindly notice <code class="docutils literal notranslate"><span class="pre">dm_control</span></code> should you have further problems, please refer to the official <a class="reference external" href="https://github.com/deepmind/dm_control">related instructions</a>)</p>
<p>Note: If you need to install the corresponding package to the user directory (If the user does not own root authority,then the corresponding package needs to be installed to the user directory),please add <code class="docutils literal notranslate"><span class="pre">--user</span></code> after the install command.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install Directly</span>
pip install gym
pip install dm_control
pip install git+git://github.com/denisyarats/dmc2gym.git
</pre></div>
</div>
</section>
<section id="verify-installation">
<h3>Verify Installation<a class="headerlink" href="#verify-installation" title="Permalink to this headline">¶</a></h3>
<p>After the installation is complete, you can verify that the installation was successful by running the following command on the Python command line:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dmc2gym</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">dmc2gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">domain_name</span><span class="o">=</span><span class="s1">&#39;point_mass&#39;</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s1">&#39;easy&#39;</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obs</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>    <span class="c1"># (4,)</span>
</pre></div>
</div>
</section>
<section id="image">
<h3>Image<a class="headerlink" href="#image" title="Permalink to this headline">¶</a></h3>
<p>DI-engine image comes with the framwork and the dmc2gym environment, which is available via <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">pull</span> <span class="pre">opendilab/ding:nightly-dmc2gym</span></code>, or by visiting<a class="reference external" href="https://hub.docker.com/r/opendilab/ding">docker hub</a>to get more images.</p>
</section>
</section>
<section id="environment-introduction">
<h2>Environment Introduction<a class="headerlink" href="#environment-introduction" title="Permalink to this headline">¶</a></h2>
<section id="select-task">
<h3>select task<a class="headerlink" href="#select-task" title="Permalink to this headline">¶</a></h3>
<p>dm_control contains multiple domains (physical models), and different domains have different tasks (instances of models with specific MDP structures). We have temporarily implemented the following domain and task here:</p>
<ul>
<li><p>Ball in cup</p>
<blockquote>
<div><a class="reference internal image-reference" href="../_images/dmc2gym-ball_in_cup.png"><img alt="../_images/dmc2gym-ball_in_cup.png" class="align-center" src="../_images/dmc2gym-ball_in_cup.png" style="width: 300px;" /></a>
</div></blockquote>
<p>Flact Ball Cup task. A driven plane container can translate in a vertical plane in order to swing and catch a ball attached to its base. The reward for the catch task is 1 when the ball is in the cup, and 0 otherwise.</p>
<ul class="simple">
<li><p>catch</p></li>
</ul>
</li>
<li><p>Cart-pole</p>
<blockquote>
<div><a class="reference internal image-reference" href="../_images/dmc2gym-cartpole.png"><img alt="../_images/dmc2gym-cartpole.png" class="align-center" src="../_images/dmc2gym-cartpole.png" style="width: 300px;" /></a>
</div></blockquote>
<p>Conforms to the physical model proposed by <a class="reference external" href="https://ieeexplore.ieee.org/abstract/document/6313077">Barto et al. 1983</a>. The target is to swing and balance the unactuated pole by applying force to the cart at its bottom. This environment implements the following tasks</p>
<ul class="simple">
<li><p>balance: the initial bar is close to the post</p></li>
<li><p>swingup: the initial bar points down</p></li>
</ul>
</li>
<li><p>Cheetah</p>
<blockquote>
<div><a class="reference internal image-reference" href="../_images/dmc2gym-cheetah.png"><img alt="../_images/dmc2gym-cheetah.png" class="align-center" src="../_images/dmc2gym-cheetah.png" style="width: 300px;" /></a>
</div></blockquote>
<p>Planar running bipeds, based on the model proposed by <a class="reference external" href="https://www.sciencedirect.com/science/article/abs/pii/S0893608009001026">Wawrzyński et al. 2009</a>, reward <code class="docutils literal notranslate"><span class="pre">r</span></code>and speed of advance <code class="docutils literal notranslate"><span class="pre">v</span></code>has a linear relationship, <code class="docutils literal notranslate"><span class="pre">v</span></code>is up to 10m/s, <code class="docutils literal notranslate"><span class="pre">r(v)</span> <span class="pre">=</span> <span class="pre">max(0,</span> <span class="pre">min(v/10,</span> <span class="pre">1))</span></code>.</p>
<ul class="simple">
<li><p>run</p></li>
</ul>
</li>
<li><p>Finger</p>
<blockquote>
<div><a class="reference internal image-reference" href="../_images/dmc2gym-finger.png"><img alt="../_images/dmc2gym-finger.png" class="align-center" src="../_images/dmc2gym-finger.png" style="width: 300px;" /></a>
</div></blockquote>
<p>Based on the problem of the 3-DOF toy manipulation problem proposed by <a class="reference external" href="https://homes.cs.washington.edu/~todorov/papers/TassaRSS10.pdf">Tassa et al. 2010</a>. A “finger” is used on the plane to rotate the object on a hinge with no other driving force, so that the tip of the object overlaps the target.</p>
<ul class="simple">
<li><p>spin: In this task, the object must be constantly spinning.</p></li>
</ul>
</li>
<li><p>Reacher</p>
<blockquote>
<div><a class="reference internal image-reference" href="../_images/dmc2gym-reacher.png"><img alt="../_images/dmc2gym-reacher.png" class="align-center" src="../_images/dmc2gym-reacher.png" style="width: 300px;" /></a>
</div></blockquote>
<p>Simple two-link planar stretcher with random target positions. The reward is 1 when the end of the rod penetrates the target sphere.</p>
<ul class="simple">
<li><p>easy: The target sphere is bigger than in hard missions.</p></li>
</ul>
</li>
<li><p>Walker</p>
<blockquote>
<div><a class="reference internal image-reference" href="../_images/dmc2gym-walker.png"><img alt="../_images/dmc2gym-walker.png" class="align-center" src="../_images/dmc2gym-walker.png" style="width: 300px;" /></a>
</div></blockquote>
<p>An improved planar walker based on the <a class="reference external" href="https://arxiv.org/abs/1509.02971">Lillicrap et al. 2015</a>model. The walk task contains a component incentive to move forward quickly.</p>
<ul class="simple">
<li><p>walk</p></li>
</ul>
</li>
</ul>
<p>Called by setting the parameters <code class="docutils literal notranslate"><span class="pre">domain_name</span></code>,<code class="docutils literal notranslate"><span class="pre">task_name</span></code>：</p>
<ul class="simple">
<li><p>e.g</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">env</span> <span class="o">=</span> <span class="n">DMC2GymEnv</span><span class="p">(</span><span class="n">EasyDict</span><span class="p">({</span>
    <span class="s2">&quot;domain_name&quot;</span><span class="p">:</span> <span class="s2">&quot;cartpole&quot;</span><span class="p">,</span>
    <span class="s2">&quot;task_name&quot;</span><span class="p">:</span> <span class="s2">&quot;balance&quot;</span><span class="p">,</span>
<span class="p">}))</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The corresponding state space, action space, observation space<code class="docutils literal notranslate"><span class="pre">(dim(S),</span> <span class="pre">dim(A),</span> <span class="pre">dim(O))</span></code>are shown in the following table:</p></li>
</ul>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 18%" />
<col style="width: 21%" />
<col style="width: 21%" />
<col style="width: 19%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Domain</p></th>
<th class="head"><p>Task</p></th>
<th class="head"><p>dim(S)</p></th>
<th class="head"><p>dim(A)</p></th>
<th class="head"><p>dim(O)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ball in cup</p></td>
<td><p>catch</p></td>
<td><p>8</p></td>
<td><p>2</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><p>cart-pole</p></td>
<td><p>balance</p></td>
<td><p>4</p></td>
<td><p>1</p></td>
<td><p>5</p></td>
</tr>
<tr class="row-even"><td><p>swingup</p></td>
<td><p>4</p></td>
<td><p>1</p></td>
<td><p>5</p></td>
</tr>
<tr class="row-odd"><td><p>cheetah</p></td>
<td><p>run</p></td>
<td><p>18</p></td>
<td><p>6</p></td>
<td><p>17</p></td>
</tr>
<tr class="row-even"><td><p>finger</p></td>
<td><p>spin</p></td>
<td><p>6</p></td>
<td><p>2</p></td>
<td><p>12</p></td>
</tr>
<tr class="row-odd"><td><p>reacher</p></td>
<td><p>easy</p></td>
<td><p>4</p></td>
<td><p>2</p></td>
<td><p>7</p></td>
</tr>
<tr class="row-even"><td><p>walker</p></td>
<td><p>walk</p></td>
<td><p>18</p></td>
<td><p>6</p></td>
<td><p>24</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The task in dm_control follows the Markov Decision Process (MDP).</p>
<blockquote>
<div><ul class="simple">
<li><p>State <code class="docutils literal notranslate"><span class="pre">s</span></code>is a real vector except for the spatial direction <span class="math notranslate nohighlight">\(\cal{S} \equiv \mathbb{R}^{dim(\cal{S})}\)</span> , where the spatial direction is represented by Unit quaternion <span class="math notranslate nohighlight">\(\in SU(2)\)</span></p></li>
<li><p>Observation <code class="docutils literal notranslate"><span class="pre">o(s,</span> <span class="pre">a)</span></code>describes the state that the agent can observe. The tasks we implement are all strongly observable, that is, the state can be recovered from a single observation. The observed features that depend only on the state (position and velocity) are a function of the current state. Observations that also depend on controls (such as touch sensor readings) are functions of previous transitions.</p></li>
</ul>
</div></blockquote>
</div>
</section>
<section id="obervation-space">
<h3>Obervation Space<a class="headerlink" href="#obervation-space" title="Permalink to this headline">¶</a></h3>
<section id="based-on-image-observation">
<h4>Based on Image Observation<a class="headerlink" href="#based-on-image-observation" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>When setting <code class="docutils literal notranslate"><span class="pre">from_pixels=True</span></code>, the observation space is a three-channel game image with height and width respectively.</p></li>
<li><p>The size of the observed image can be adjusted by setting the <code class="docutils literal notranslate"><span class="pre">height,</span> <span class="pre">width</span></code>parameters.</p></li>
<li><p>Observe the specific shape of the observation space by setting <code class="docutils literal notranslate"><span class="pre">channels_first</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">channels_first=True</span></code>, observation shape is <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">height,</span> <span class="pre">width]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">channels_first=False</span></code>, observation shape is <code class="docutils literal notranslate"><span class="pre">[height,</span> <span class="pre">width,</span> <span class="pre">3]</span></code></p></li>
</ul>
</li>
<li><p>The range of a single pixel value for each channel is <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">255]</span></code>, and the data type is <code class="docutils literal notranslate"><span class="pre">uint8</span></code></p></li>
</ul>
</section>
<section id="non-image-based-observation">
<h4>Non-Image Based Observation<a class="headerlink" href="#non-image-based-observation" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>When <code class="docutils literal notranslate"><span class="pre">from_pixels=False</span></code>is set, the observation space dimension follows <code class="docutils literal notranslate"><span class="pre">dim(O)</span></code>in the above table</p></li>
<li><p>The default range is <code class="docutils literal notranslate"><span class="pre">[-inf,</span> <span class="pre">inf]</span></code></p></li>
</ul>
</section>
</section>
<section id="action-space">
<h3>Action Space<a class="headerlink" href="#action-space" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Action space dimensions follow <code class="docutils literal notranslate"><span class="pre">dim(A)</span></code>in the above table</p></li>
<li><p>dmc2gym normalizes the action space, the range of each dimension is <code class="docutils literal notranslate"><span class="pre">[-1,</span> <span class="pre">1]</span></code>, the type is <code class="docutils literal notranslate"><span class="pre">float32</span></code>.</p></li>
</ul>
</section>
<section id="reward-space">
<h3>Reward Space<a class="headerlink" href="#reward-space" title="Permalink to this headline">¶</a></h3>
<section id="image-based-observation">
<h4>Image Based Observation<a class="headerlink" href="#image-based-observation" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p>It is related to the <code class="docutils literal notranslate"><span class="pre">frame_skip</span></code>parameter, which means that each step is based on the image of <code class="docutils literal notranslate"><span class="pre">frame_skip</span></code>frame , and the dimension is <code class="docutils literal notranslate"><span class="pre">(1,)</span></code></p></li>
<li><p>The range is <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">frame_skip]</span></code>, the type is <code class="docutils literal notranslate"><span class="pre">float32</span></code>, default <code class="docutils literal notranslate"><span class="pre">frame_skip</span> <span class="pre">=</span> <span class="pre">1</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p>The reward space of each frame is <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1]</span></code>, and the reward of <code class="docutils literal notranslate"><span class="pre">frame_skip</span></code>are superimposed together as the overall reward</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
<section id="id1">
<h4>Non-Image Based Observation<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>The dimension is <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">)</span></code>, the range is  <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1]</span></code>, the type is <code class="docutils literal notranslate"><span class="pre">float32</span></code>.</p></li>
</ul>
</section>
</section>
</section>
<section id="other">
<h2>Other<a class="headerlink" href="#other" title="Permalink to this headline">¶</a></h2>
<section id="abort-condition">
<h3>Abort Condition<a class="headerlink" href="#abort-condition" title="Permalink to this headline">¶</a></h3>
<p>Control tasks are divided into finite-horizon, firstexit and infinite-horizon. DeepMind Control Suite belongs to infinite-horizon, so there is no aborted state or time limit for tasks.</p>
</section>
<section id="lazy-initialization">
<h3>Lazy Initialization<a class="headerlink" href="#lazy-initialization" title="Permalink to this headline">¶</a></h3>
<p>In order to facilitate parallel operations such as environment vectorization, environment instances generally implement lazy initialization , which means <code class="docutils literal notranslate"><span class="pre">__init__</span></code>method does not initialize the real original environment instance, but only sets relevant parameters and configuration values. The concrete original environment instance is initialized when the <code class="docutils literal notranslate"><span class="pre">reset</span></code>method is used.</p>
</section>
<section id="random-seeds">
<h3>Random Seeds<a class="headerlink" href="#random-seeds" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>There are two parts of random seeds in the environment that need to be set, one is the random seed of the original environment, and the other is the random seed of the random library used by various environment transformations(such as <code class="docutils literal notranslate"><span class="pre">random</span></code>, <code class="docutils literal notranslate"><span class="pre">np.random</span></code>)</p></li>
<li><p>For the environment caller, just set two seeds through the<code class="docutils literal notranslate"><span class="pre">seed</span></code>method of the environment, and do not need to care about the specific implementation details.</p></li>
</ul>
</section>
<section id="concrete-implementation-inside-the-environment">
<h3>Concrete implementation inside the environment<a class="headerlink" href="#concrete-implementation-inside-the-environment" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>For the seed of the original environment, set in the <code class="docutils literal notranslate"><span class="pre">reset</span></code>methods of the environment calling function , before the concrete environment implementation  <code class="docutils literal notranslate"><span class="pre">reset</span></code></p></li>
<li><p>For random library seeds, set the value directly in the <code class="docutils literal notranslate"><span class="pre">seed</span></code>method of the environment ; for the seed of the original environment, inside the <code class="docutils literal notranslate"><span class="pre">reset</span></code>method of the calling environment, the specific original environment <code class="docutils literal notranslate"><span class="pre">reset</span></code>was previously set to seed + np_seed, where seed is the value of the aforementioned random library seed,
np_seed = 100 * np.random.randint(1, 1000).</p></li>
</ul>
</section>
<section id="store-video">
<h3>Store Video<a class="headerlink" href="#store-video" title="Permalink to this headline">¶</a></h3>
<p>After the environment is created, but before reset, call the <code class="docutils literal notranslate"><span class="pre">enable_save_replay</span></code>method，to specify the path to save the game recording. The environment will automatically save the local video files after each episode ends. (The default implementation of calling <code class="docutils literal notranslate"><span class="pre">gym.wrappers.RecordVideo</span></code>），the code shown below will run an environment episode and save the results of this episode in <code class="docutils literal notranslate"><span class="pre">./video/</span></code>：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">easydict</span> <span class="kn">import</span> <span class="n">EasyDict</span>
<span class="kn">from</span> <span class="nn">dizoo.dmc2gym.envs</span> <span class="kn">import</span> <span class="n">DMC2GymEnv</span>

<span class="n">env</span> <span class="o">=</span> <span class="n">DMC2GymEnv</span><span class="p">(</span><span class="n">EasyDict</span><span class="p">({</span>
     <span class="s2">&quot;domain_name&quot;</span><span class="p">:</span> <span class="s2">&quot;cartpole&quot;</span><span class="p">,</span>
     <span class="s2">&quot;task_name&quot;</span><span class="p">:</span> <span class="s2">&quot;balance&quot;</span><span class="p">,</span>
     <span class="s2">&quot;frame_skip&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
     <span class="s2">&quot;from_pixels&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
 <span class="p">}))</span>
<span class="n">env</span><span class="o">.</span><span class="n">enable_save_replay</span><span class="p">(</span><span class="n">replay_path</span><span class="o">=</span><span class="s1">&#39;./video&#39;</span><span class="p">)</span>
<span class="n">env</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">314</span><span class="p">,</span> <span class="n">dynamic_seed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">action</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">random_action</span><span class="p">()</span>
    <span class="n">timestep</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">timestep</span><span class="o">.</span><span class="n">done</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Episode is over, final eval reward is: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">timestep</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;final_eval_reward&#39;</span><span class="p">]))</span>
        <span class="k">break</span>
</pre></div>
</div>
</section>
</section>
<section id="di-zoo-runnable-code-example">
<h2>DI-zoo Runnable Code Example<a class="headerlink" href="#di-zoo-runnable-code-example" title="Permalink to this headline">¶</a></h2>
<p>The complete example file is at  <a class="reference external" href="https://github.com/opendilab/DI-engine/blob/main/dizoo/dmc2gym/entry/dmc2gym_save_replay_example.py">github
link</a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">easydict</span> <span class="kn">import</span> <span class="n">EasyDict</span>

<span class="n">cartpole_balance_ddpg_config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">exp_name</span><span class="o">=</span><span class="s1">&#39;dmc2gym_cartpole_balance_ddpg_eval&#39;</span><span class="p">,</span>
    <span class="n">env</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">env_id</span><span class="o">=</span><span class="s1">&#39;dmc2gym_cartpole_balance&#39;</span><span class="p">,</span>
        <span class="n">domain_name</span><span class="o">=</span><span class="s1">&#39;cartpole&#39;</span><span class="p">,</span>
        <span class="n">task_name</span><span class="o">=</span><span class="s1">&#39;balance&#39;</span><span class="p">,</span>
        <span class="n">from_pixels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">norm_obs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">use_norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="p">),</span>
        <span class="n">norm_reward</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">use_norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="p">),</span>
        <span class="n">collector_env_num</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">evaluator_env_num</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
        <span class="n">use_act_scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">n_evaluator_episode</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
        <span class="n">replay_path</span><span class="o">=</span><span class="s1">&#39;./dmc2gym_cartpole_balance_ddpg_eval/video&#39;</span><span class="p">,</span>
        <span class="n">stop_value</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">policy</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">cuda</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">random_collect_size</span><span class="o">=</span><span class="mi">2560</span><span class="p">,</span>
        <span class="n">load_path</span><span class="o">=</span><span class="s2">&quot;./dmc2gym_cartpole_balance_ddpg/ckpt/iteration_10000.pth.tar&quot;</span><span class="p">,</span>
        <span class="n">model</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">obs_shape</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
            <span class="n">action_shape</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">twin_critic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">actor_head_hidden_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
            <span class="n">critic_head_hidden_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
            <span class="n">action_space</span><span class="o">=</span><span class="s1">&#39;regression&#39;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">learn</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">update_per_collect</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
            <span class="n">learning_rate_actor</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
            <span class="n">learning_rate_critic</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
            <span class="n">ignore_done</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">target_theta</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span>
            <span class="n">discount_factor</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span>
            <span class="n">actor_update_freq</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">noise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">collect</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">n_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">unroll_len</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">noise_sigma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">other</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">replay_buffer</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">replay_buffer_size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="p">),</span> <span class="p">),</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">cartpole_balance_ddpg_config</span> <span class="o">=</span> <span class="n">EasyDict</span><span class="p">(</span><span class="n">cartpole_balance_ddpg_config</span><span class="p">)</span>
<span class="n">main_config</span> <span class="o">=</span> <span class="n">cartpole_balance_ddpg_config</span>

<span class="n">cartpole_balance_create_config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">env</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;dmc2gym&#39;</span><span class="p">,</span>
        <span class="n">import_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dizoo.dmc2gym.envs.dmc2gym_env&#39;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="n">env_manager</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;base&#39;</span><span class="p">),</span>
    <span class="n">policy</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;ddpg&#39;</span><span class="p">,</span>
        <span class="n">import_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ding.policy.ddpg&#39;</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="n">replay_buffer</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;naive&#39;</span><span class="p">,</span> <span class="p">),</span>
<span class="p">)</span>
<span class="n">cartpole_balance_create_config</span> <span class="o">=</span> <span class="n">EasyDict</span><span class="p">(</span><span class="n">cartpole_balance_create_config</span><span class="p">)</span>
<span class="n">create_config</span> <span class="o">=</span> <span class="n">cartpole_balance_create_config</span>
</pre></div>
</div>
</section>
</section>


              </article>
              
            </div>
            <footer>
  
  <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
    
    <a href="gym_hybrid.html" class="btn btn-neutral float-right" title="gym hybrid" accesskey="n"
      rel="next">Next <img src="../_static/images/chevron-right-blue.svg"
        class="next-page"></a>
    
    
    <a href="pettingzoo.html" class="btn btn-neutral" title="PettingZoo" accesskey="p"
      rel="prev"><img src="../_static/images/chevron-right-blue.svg" class="previous-page"> Previous</a>
    
  </div>
  

  <hr>

  <div role="contentinfo">
    <p>
      &copy; Copyright 2021, OpenDILab Contributors.

    </p>
  </div>
  
  <div>
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a
      href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the
      Docs</a>.
  </div>
   

</footer>
          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">dmc2gym</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#installation">Installation</a><ul>
<li><a class="reference internal" href="#method">Method</a></li>
<li><a class="reference internal" href="#verify-installation">Verify Installation</a></li>
<li><a class="reference internal" href="#image">Image</a></li>
</ul>
</li>
<li><a class="reference internal" href="#environment-introduction">Environment Introduction</a><ul>
<li><a class="reference internal" href="#select-task">select task</a></li>
<li><a class="reference internal" href="#obervation-space">Obervation Space</a><ul>
<li><a class="reference internal" href="#based-on-image-observation">Based on Image Observation</a></li>
<li><a class="reference internal" href="#non-image-based-observation">Non-Image Based Observation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#action-space">Action Space</a></li>
<li><a class="reference internal" href="#reward-space">Reward Space</a><ul>
<li><a class="reference internal" href="#image-based-observation">Image Based Observation</a></li>
<li><a class="reference internal" href="#id1">Non-Image Based Observation</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#other">Other</a><ul>
<li><a class="reference internal" href="#abort-condition">Abort Condition</a></li>
<li><a class="reference internal" href="#lazy-initialization">Lazy Initialization</a></li>
<li><a class="reference internal" href="#random-seeds">Random Seeds</a></li>
<li><a class="reference internal" href="#concrete-implementation-inside-the-environment">Concrete implementation inside the environment</a></li>
<li><a class="reference internal" href="#store-video">Store Video</a></li>
</ul>
</li>
<li><a class="reference internal" href="#di-zoo-runnable-code-example">DI-zoo Runnable Code Example</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
    </section>
  </div>

  


  

  
  <script type="text/javascript" id="documentation_options" data-url_root="../"
    src="../_static/documentation_options.js"></script>
  <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
  <script src="../_static/jquery.js"></script>
  <script src="../_static/underscore.js"></script>
  <script src="../_static/doctools.js"></script>
  <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  

  

  <script type="text/javascript" src="../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
  </div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://di-engine-docs.readthedocs.io/en/latest/" aria-label="OpenMMLab"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://github.com/opendilab/DI-engine" target="_blank">GitHub</a>
          </li>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function () {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function (e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>

</html>