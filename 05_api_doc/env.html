


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ding.envs &mdash; DI-engine 0.1.0 documentation</title>
  

  <link rel="shortcut icon" href="../_static/images/favicon.ico" />
  
  

  

  
  
  

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/style.css" type="text/css" />
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="next" title="ding.model" href="model.html" />
  <link rel="prev" title="ding.config" href="config.html" />
    <link href="../_static/css/style.css" rel="stylesheet" type="text/css">


  
  <script src="../_static/js/modernizr.min.js"></script>
  <script>
    MathJax = {
        chtml: {
            scale: 1,
            minScale: 1,
        },
        svg: {
            scale: 1,
            minScale: 1,
        }
    }
</script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"
    integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://di-engine-docs.readthedocs.io/en/latest/"
        aria-label="OpenMMLab"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://github.com/opendilab/DI-engine" target="_blank">GitHub</a>
          </li>
          <li >
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a
                class="resource-option with-down-arrow">
                OpenDILab
              </a>
              <div class="resources-dropdown-menu">
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/DI-engine" target="_blank">
                  <span class="dropdown-title">DI-engine </span>
                  <p>OpenDILab Decision AI Engine</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/DI-star" target="_blank">
                  <span class="dropdown-title">DI-star </span>
                  <p>OpenDILab Decision AI in StarCraftII</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/DI-drive" target="_blank">
                  <span class="dropdown-title">DI-drive </span>
                  <p>OpenDILab Auto-driving platform</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/GoBigger" target="_blank">
                  <span class="dropdown-title">GoBigger </span>
                  <p>OpenDILab Multi-Agent Environment</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/DI-smartcross" target="_blank">
                  <span class="dropdown-title">DI-smartcross </span>
                  <p>Decision Intelligence Platform for Traffic Crossing Signal Control</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/DI-treetensor" target="_blank">
                  <span class="dropdown-title">DI-treetensor </span>
                  <p>Tree Nested PyTorch Tensor Lib</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/DI-sheep" target="_blank">
                  <span class="dropdown-title">DI-sheep </span>
                  <p>Deep Reinforcement Learning + 3 Tiles Game</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/awesome-model-based-RL" target="_blank">
                  <span class="dropdown-title">awesome-model-based-RL </span>
                  <p>A curated list of awesome model based RL resources (continually updated)</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/awesome-decision-transformer" target="_blank">
                  <span class="dropdown-title">awesome-decision-transformer </span>
                  <p>A curated list of Decision Transformer resources (continually updated)</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/awesome-exploration-rl" target="_blank">
                  <span class="dropdown-title">awesome-exploration-rl </span>
                  <p>A curated list of awesome exploration RL resources (continually updated)</p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item"
                  href="https://github.com/opendilab/awesome-multi-modal-reinforcement-learning" target="_blank">
                  <span class="dropdown-title">awesome-multi-modal-reinforcement-learning </span>
                  <p>A curated list of Multi-Modal Reinforcement Learning resources (continually updated)</p>
                </a>
              </div>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>
  </div>
</div>

<body class="pytorch-body">

   

  

  <div class="table-of-contents-link-wrapper">
    <span>Table of Contents</span>
    <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
  </div>

  <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
    <div class="pytorch-side-scroll">
      <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <div class="pytorch-left-menu-search">
          

          
          
          
          

          



<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        
        
        
        
        
        <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../00_intro/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_quickstart/index.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_algo/index.html">RL Algorithm Taxonomy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_system/index.html">System Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_best_practice/index.html">Best Practice</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API Doc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06_faq/index.html">FAQ</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reinforcement Learning Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../10_concepts/index.html">Introduction to RL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11_dizoo/index.html">Learn From DI-zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../12_policies/index.html">RL Algorithms Cheat Sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../13_envs/index.html">RL Env Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Specification</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../20_spec/index.html">Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../21_code_style/index.html">Code Style Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../22_test/index.html">Unit Test Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../23_visual/index.html">Diagrams and Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../24_cooperation/index.html">Github Cooperation</a></li>
</ul>

        
        
      </div>
    </div>
  </nav>

  <div class="pytorch-container">
    <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
      <div class="pytorch-breadcrumbs-wrapper">
        















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../index.html">
            Docs
        </a> &gt;
      </li>

        
          <li><a href="index.html">API Doc</a> &gt;</li>
        
      <li>ding.envs</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="../_sources/05_api_doc/env.rst.txt" rel="nofollow"><img src="../_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
      </div>

      <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
        Shortcuts
      </div>
    </div>

    <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
      <div class="pytorch-content-left">
        
          <div class="rst-content">
            
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
              <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
                
  <section id="ding-envs">
<h1>ding.envs<a class="headerlink" href="#ding-envs" title="Permalink to this headline">¶</a></h1>
<section id="env">
<h2>Env<a class="headerlink" href="#env" title="Permalink to this headline">¶</a></h2>
<p>Please refer to <code class="docutils literal notranslate"><span class="pre">ding/envs/env</span></code> for more details.</p>
<section id="baseenv">
<h3>BaseEnv<a class="headerlink" href="#baseenv" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.BaseEnv">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">BaseEnv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env/base_env.html#BaseEnv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.BaseEnv" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Basic environment class, extended from <code class="docutils literal notranslate"><span class="pre">gym.Env</span></code></p>
</dd>
<dt>Interface:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">__init__</span></code>, <code class="docutils literal notranslate"><span class="pre">reset</span></code>, <code class="docutils literal notranslate"><span class="pre">close</span></code>, <code class="docutils literal notranslate"><span class="pre">step</span></code>, <code class="docutils literal notranslate"><span class="pre">random_action</span></code>, <code class="docutils literal notranslate"><span class="pre">create_collector_env_cfg</span></code>,         <code class="docutils literal notranslate"><span class="pre">create_evaluator_env_cfg</span></code>, <code class="docutils literal notranslate"><span class="pre">enable_save_replay</span></code></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnv.__init__">
<em class="property"><span class="pre">abstract</span> </em><span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env/base_env.html#BaseEnv.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.BaseEnv.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Lazy init, only related arguments will be initialized in <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method, and the concrete             env will be initialized the first time <code class="docutils literal notranslate"><span class="pre">reset</span></code> method is called.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code>): Environment configuration in dict type.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnv.close">
<em class="property"><span class="pre">abstract</span> </em><span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env/base_env.html#BaseEnv.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.BaseEnv.close" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Close env and all the related resources, it should be called after the usage of env instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnv.create_collector_env_cfg">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">create_collector_env_cfg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/ding/envs/env/base_env.html#BaseEnv.create_collector_env_cfg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.BaseEnv.create_collector_env_cfg" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return a list of all of the environment from input config, used in env manager             (a series of vectorized env), and this method is mainly responsible for envs collecting data.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code>): Original input env config, which needs to be transformed into the type of creating                 env instance actually and generated the corresponding number of configurations.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>env_cfg_list (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[dict]</span></code>): List of <code class="docutils literal notranslate"><span class="pre">cfg</span></code> including all the config collector envs.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Elements(env config) in collector_env_cfg/evaluator_env_cfg can be different, such as server ip and port.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnv.create_evaluator_env_cfg">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">create_evaluator_env_cfg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/ding/envs/env/base_env.html#BaseEnv.create_evaluator_env_cfg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.BaseEnv.create_evaluator_env_cfg" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return a list of all of the environment from input config, used in env manager             (a series of vectorized env), and this method is mainly responsible for envs evaluating performance.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code>): Original input env config, which needs to be transformed into the type of creating                 env instance actually and generated the corresponding number of configurations.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>env_cfg_list (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[dict]</span></code>): List of <code class="docutils literal notranslate"><span class="pre">cfg</span></code> including all the config evaluator envs.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnv.enable_save_replay">
<span class="sig-name descname"><span class="pre">enable_save_replay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">replay_path</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env/base_env.html#BaseEnv.enable_save_replay"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.BaseEnv.enable_save_replay" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Save replay file in the given path, and this method need to be self-implemented by each env class.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>replay_path (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>): The path to save replay file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnv.random_action">
<span class="sig-name descname"><span class="pre">random_action</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/ding/envs/env/base_env.html#BaseEnv.random_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.BaseEnv.random_action" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return random action generated from the original action space, usually it is convenient for test.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>random_action (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>): Action generated randomly.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnv.reset">
<em class="property"><span class="pre">abstract</span> </em><span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/ding/envs/env/base_env.html#BaseEnv.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.BaseEnv.reset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset the env to an initial state and returns an initial observation.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>obs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>): Initial observation after reset.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnv.step">
<em class="property"><span class="pre">abstract</span> </em><span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">BaseEnv.timestep</span></span></span><a class="reference internal" href="../_modules/ding/envs/env/base_env.html#BaseEnv.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.BaseEnv.step" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Run one timestep of the environment’s dynamics/simulation.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>action (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>): The <code class="docutils literal notranslate"><span class="pre">action</span></code> input to step with.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>timestep (<code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseEnv.timestep</span></code>): The result timestep of env executing one step.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="get-vec-env-setting">
<h3>get_vec_env_setting<a class="headerlink" href="#get-vec-env-setting" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="ding.envs.get_vec_env_setting">
<span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">get_vec_env_setting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collect</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">type</span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/ding/envs/env/base_env.html#get_vec_env_setting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.get_vec_env_setting" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get vectorized env setting (env_fn, collector_env_cfg, evaluator_env_cfg).</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code>): Original input env config in user config, such as <code class="docutils literal notranslate"><span class="pre">cfg.env</span></code>.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>env_fn (<code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>): Callable object, call it with proper arguments and then get a new env instance.</p></li>
<li><p>collector_env_cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[dict]</span></code>): A list contains the config of collecting data envs.</p></li>
<li><p>evaluator_env_cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[dict]</span></code>): A list contains the config of evaluation envs.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Elements (env config) in collector_env_cfg/evaluator_env_cfg can be different, such as server ip and port.</p>
</div>
</dd></dl>

</section>
<section id="get-env-cls">
<h3>get_env_cls<a class="headerlink" href="#get-env-cls" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="ding.envs.get_env_cls">
<span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">get_env_cls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">easydict.EasyDict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">type</span></span></span><a class="reference internal" href="../_modules/ding/envs/env/base_env.html#get_env_cls"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.get_env_cls" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the env class by correspondng module of <code class="docutils literal notranslate"><span class="pre">cfg</span></code> and return the callable class.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code>): Original input env config in user config, such as <code class="docutils literal notranslate"><span class="pre">cfg.env</span></code>.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>env_cls_type (<code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>): Env module as the corresponding callable class type.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="dingenvwrapper">
<h3>DingEnvWrapper<a class="headerlink" href="#dingenvwrapper" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.DingEnvWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">DingEnvWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">gym.core.Env</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed_api</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caller</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'collector'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env/ding_env_wrapper.html#DingEnvWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.DingEnvWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>This is a wrapper for the BaseEnv class, used to provide a consistent environment interface.</p>
</dd>
<dt>Interfaces:</dt><dd><p>__init__, reset, step, close, seed, random_action, _wrap_env, __repr__, create_collector_env_cfg,
create_evaluator_env_cfg, enable_save_replay, observation_space, action_space, reward_space, clone</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.DingEnvWrapper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">gym.core.Env</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed_api</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caller</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'collector'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env/ding_env_wrapper.html#DingEnvWrapper.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.DingEnvWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the DingEnvWrapper. Either an environment instance or a config to create the environment             instance should be passed in. For the former, i.e., an environment instance: The <cite>env</cite> parameter must not             be <cite>None</cite>, but should be the instance. It does not support subprocess environment manager. Thus, it is             usually used in simple environments. For the latter, i.e., a config to create an environment instance:             The <cite>cfg</cite> parameter must contain <cite>env_id</cite>.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): An environment instance to be wrapped.</p></li>
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code>): The configuration dictionary to create an environment instance.</p></li>
<li><p>seed_api (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether to use seed API. Defaults to True.</p></li>
<li><p>caller (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>): A string representing the caller of this method, including <code class="docutils literal notranslate"><span class="pre">collector</span></code> or                 <code class="docutils literal notranslate"><span class="pre">evaluator</span></code>. Different caller may need different wrappers. Default is ‘collector’.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.DingEnvWrapper.action_space">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">action_space</span></span><em class="property"><span class="pre">:</span> <span class="pre">gym.spaces.space.Space</span></em><a class="headerlink" href="#ding.envs.DingEnvWrapper.action_space" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the action space of the wrapped environment.
The action space represents the range and shape of possible actions
that the agent can take in the environment.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>action_space (gym.spaces.Space): The action space of the environment.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.DingEnvWrapper.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">caller</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'collector'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#ding.envs.BaseEnv" title="ding.envs.env.base_env.BaseEnv"><span class="pre">ding.envs.env.base_env.BaseEnv</span></a></span></span><a class="reference internal" href="../_modules/ding/envs/env/ding_env_wrapper.html#DingEnvWrapper.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.DingEnvWrapper.clone" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Clone the current environment wrapper, creating a new environment with the same settings.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>caller (str): A string representing the caller of this method, including <code class="docutils literal notranslate"><span class="pre">collector</span></code> or <code class="docutils literal notranslate"><span class="pre">evaluator</span></code>.                 Different caller may need different wrappers. Default is ‘collector’.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>DingEnvWrapper: A new instance of the environment with the same settings.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.DingEnvWrapper.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env/ding_env_wrapper.html#DingEnvWrapper.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.DingEnvWrapper.close" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Clean up the environment by closing and deleting it.
This method should be called when the environment is no longer needed.
Failing to call this method can lead to memory leaks.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.DingEnvWrapper.create_collector_env_cfg">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">create_collector_env_cfg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/ding/envs/env/ding_env_wrapper.html#DingEnvWrapper.create_collector_env_cfg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.DingEnvWrapper.create_collector_env_cfg" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Create a list of environment configuration for collectors based on the input configuration.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code>): The input configuration dictionary.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>env_cfgs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[dict]</span></code>): The list of environment configurations for collectors.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.DingEnvWrapper.create_evaluator_env_cfg">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">create_evaluator_env_cfg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/ding/envs/env/ding_env_wrapper.html#DingEnvWrapper.create_evaluator_env_cfg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.DingEnvWrapper.create_evaluator_env_cfg" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Create a list of environment configuration for evaluators based on the input configuration.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code>): The input configuration dictionary.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>env_cfgs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[dict]</span></code>): The list of environment configurations for evaluators.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.DingEnvWrapper.enable_save_replay">
<span class="sig-name descname"><span class="pre">enable_save_replay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">replay_path</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env/ding_env_wrapper.html#DingEnvWrapper.enable_save_replay"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.DingEnvWrapper.enable_save_replay" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Enable the save replay functionality. The replay will be saved at the specified path.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>replay_path (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Optional[str]</span></code>): The path to save the replay, default is None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.DingEnvWrapper.observation_space">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">observation_space</span></span><em class="property"><span class="pre">:</span> <span class="pre">gym.spaces.space.Space</span></em><a class="headerlink" href="#ding.envs.DingEnvWrapper.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the observation space of the wrapped environment.
The observation space represents the range and shape of possible observations
that the environment can provide to the agent.</p>
</dd>
<dt>Note:</dt><dd><p>If the data type of the observation space is float64, it’s converted to float32
for better compatibility with most machine learning libraries.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>observation_space (gym.spaces.Space): The observation space of the environment.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.DingEnvWrapper.random_action">
<span class="sig-name descname"><span class="pre">random_action</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/ding/envs/env/ding_env_wrapper.html#DingEnvWrapper.random_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.DingEnvWrapper.random_action" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return a random action from the action space of the environment.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>action (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): The random action.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.DingEnvWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/ding/envs/env/ding_env_wrapper.html#DingEnvWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.DingEnvWrapper.reset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Resets the state of the environment. If the environment is not initialized, it will be created first.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>obs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict</span></code>): The new observation after reset.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.DingEnvWrapper.reward_space">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">reward_space</span></span><em class="property"><span class="pre">:</span> <span class="pre">gym.spaces.space.Space</span></em><a class="headerlink" href="#ding.envs.DingEnvWrapper.reward_space" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the reward space of the wrapped environment.
The reward space represents the range and shape of possible rewards
that the agent can receive as a result of its actions.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>reward_space (gym.spaces.Space): The reward space of the environment.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.DingEnvWrapper.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic_seed</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env/ding_env_wrapper.html#DingEnvWrapper.seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.DingEnvWrapper.seed" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Set the seed for the environment.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>seed (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): The seed to set.</p></li>
<li><p>dynamic_seed (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether to use dynamic seed, default is True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.DingEnvWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.int64</span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ding.envs.env.base_env.BaseEnvTimestep</span></span></span><a class="reference internal" href="../_modules/ding/envs/env/ding_env_wrapper.html#DingEnvWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.DingEnvWrapper.step" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Execute the given action in the environment, and return the timestep (observation, reward, done, info).</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>action (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[np.int64,</span> <span class="pre">np.ndarray]</span></code>): The action to execute in the environment.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>timestep (<code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseEnvTimestep</span></code>): The timestep after the action execution.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="get-default-wrappers">
<h3>get_default_wrappers<a class="headerlink" href="#get-default-wrappers" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="ding.envs.get_default_wrappers">
<span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">get_default_wrappers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_wrapper_name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caller</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'collector'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/ding/envs/env/default_wrapper.html#get_default_wrappers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.get_default_wrappers" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get default wrappers for different environments used in <code class="docutils literal notranslate"><span class="pre">DingEnvWrapper</span></code>.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env_wrapper_name (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>): The name of the environment wrapper.</p></li>
<li><p>env_id (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Optional[str]</span></code>): The id of the specific environment, such as <code class="docutils literal notranslate"><span class="pre">PongNoFrameskip-v4</span></code>.</p></li>
<li><p>caller (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>): The caller of the environment, including <code class="docutils literal notranslate"><span class="pre">collector</span></code> or <code class="docutils literal notranslate"><span class="pre">evaluator</span></code>. Different             caller may need different wrappers.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>wrapper_list (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[dict]</span></code>): The list of wrappers, each element is a config of the concrete wrapper.</p></li>
</ul>
</dd>
<dt>Raises:</dt><dd><ul class="simple">
<li><p>NotImplementedError: <code class="docutils literal notranslate"><span class="pre">env_wrapper_name</span></code> is not in <code class="docutils literal notranslate"><span class="pre">['mujoco_default',</span> <span class="pre">'atari_default',</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">'gym_hybrid_default',</span> <span class="pre">'default']</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="env-manager">
<h2>Env Manager<a class="headerlink" href="#env-manager" title="Permalink to this headline">¶</a></h2>
<p>Please refer to <code class="docutils literal notranslate"><span class="pre">ding/envs/env_manager</span></code> for more details.</p>
<section id="create-env-manager">
<h3>create_env_manager<a class="headerlink" href="#create-env-manager" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="ding.envs.create_env_manager">
<span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">create_env_manager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">manager_cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">easydict.EasyDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_fn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#ding.envs.BaseEnvManager" title="ding.envs.env_manager.base_env_manager.BaseEnvManager"><span class="pre">ding.envs.env_manager.base_env_manager.BaseEnvManager</span></a></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/base_env_manager.html#create_env_manager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.create_env_manager" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Create an env manager according to <code class="docutils literal notranslate"><span class="pre">manager_cfg</span></code> and env functions.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>manager_cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>): Final merged env manager config.</p></li>
<li><p>env_fn (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[Callable]</span></code>): A list of functions to create <code class="docutils literal notranslate"><span class="pre">env_num</span></code> sub-environments.</p></li>
</ul>
</dd>
<dt>ArgumentsKeys:</dt><dd><ul class="simple">
<li><p>type (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>): Env manager type set in <code class="docutils literal notranslate"><span class="pre">ENV_MANAGER_REGISTRY.register</span></code> , such as <code class="docutils literal notranslate"><span class="pre">base</span></code> .</p></li>
<li><p>import_names (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[str]</span></code>): A list of module names (paths) to import before creating env manager, such             as <code class="docutils literal notranslate"><span class="pre">ding.envs.env_manager.base_env_manager</span></code> .</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>env_manager (<a class="reference internal" href="#ding.envs.BaseEnvManager" title="ding.envs.BaseEnvManager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseEnvManager</span></code></a>): The created env manager.</p></li>
</ul>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This method will not modify the <code class="docutils literal notranslate"><span class="pre">manager_cfg</span></code> , it will deepcopy the <code class="docutils literal notranslate"><span class="pre">manager_cfg</span></code> and then modify it.</p>
</div>
</dd></dl>

</section>
<section id="get-env-manager-cls">
<h3>get_env_manager_cls<a class="headerlink" href="#get-env-manager-cls" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="ding.envs.get_env_manager_cls">
<span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">get_env_manager_cls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">easydict.EasyDict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">type</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/base_env_manager.html#get_env_manager_cls"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.get_env_manager_cls" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the env manager class according to config, which is used to access related class variables/methods.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>manager_cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>): Final merged env manager config.</p></li>
</ul>
</dd>
<dt>ArgumentsKeys:</dt><dd><ul class="simple">
<li><p>type (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>): Env manager type set in <code class="docutils literal notranslate"><span class="pre">ENV_MANAGER_REGISTRY.register</span></code> , such as <code class="docutils literal notranslate"><span class="pre">base</span></code> .</p></li>
<li><p>import_names (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[str]</span></code>): A list of module names (paths) to import before creating env manager, such             as <code class="docutils literal notranslate"><span class="pre">ding.envs.env_manager.base_env_manager</span></code> .</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>env_manager_cls (<code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>): The corresponding env manager class.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="baseenvmanager">
<h3>BaseEnvManager<a class="headerlink" href="#baseenvmanager" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManager">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">BaseEnvManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_fn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">easydict.EasyDict</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_manager/base_env_manager.html#BaseEnvManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.BaseEnvManager" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Overview:</dt><dd><p>The basic class of env manager to manage multiple vectorized environments. BaseEnvManager define all the
necessary interfaces and derived class must extend this basic class.</p>
<p>The class is implemented by the pseudo-parallelism (i.e. serial) mechanism, therefore, this class is only
used in some tiny environments and for debug purpose.</p>
</dd>
<dt>Interfaces:</dt><dd><p>reset, step, seed, close, enable_save_replay, launch, default_config, reward_shaping, enable_save_figure</p>
</dd>
<dt>Properties:</dt><dd><p>env_num, env_ref, ready_obs, ready_obs_id, ready_imgs, done, closed, method_name_list, observation_space,         action_space, reward_space</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManager.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_fn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">easydict.EasyDict</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/base_env_manager.html#BaseEnvManager.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.BaseEnvManager.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the base env manager with callable the env function and the EasyDict-type config. Here we use
<code class="docutils literal notranslate"><span class="pre">env_fn</span></code> to ensure the lazy initialization of sub-environments, which is benetificial to resource
allocation and parallelism. <code class="docutils literal notranslate"><span class="pre">cfg</span></code> is the merged result between the default config of this class
and user’s config.
This construction function is in lazy-initialization mode, the actual initialization is in <code class="docutils literal notranslate"><span class="pre">launch</span></code>.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env_fn (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[Callable]</span></code>): A list of functions to create <code class="docutils literal notranslate"><span class="pre">env_num</span></code> sub-environments.</p></li>
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>): Final merged config.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For more details about how to merge config, please refer to the system document of DI-engine             (<a class="reference external" href="../03_system/config.html">en link</a>).</p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManager.action_space">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">action_space</span></span><em class="property"><span class="pre">:</span> <span class="pre">gym.spaces.Space</span></em><a class="headerlink" href="#ding.envs.BaseEnvManager.action_space" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">action_space</span></code> is the action space of sub-environment, following the format of gym.spaces.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>action_space (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.spaces.Space</span></code>): The action space of sub-environment.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManager.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/base_env_manager.html#BaseEnvManager.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.BaseEnvManager.close" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Close the env manager and release all the environment resources.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManager.closed">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">closed</span></span><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#ding.envs.BaseEnvManager.closed" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">closed</span></code> is a property that returns whether the env manager is closed.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>closed (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether the env manager is closed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManager.default_config">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">easydict.EasyDict</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/base_env_manager.html#BaseEnvManager.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.BaseEnvManager.default_config" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the deepcopyed default config of env manager.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>): The default config of env manager.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManager.done">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">done</span></span><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#ding.envs.BaseEnvManager.done" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">done</span></code> is a flag to indicate whether env manager is done, i.e., whether all sub-environments have             executed enough episodes.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>done (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether env manager is done.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManager.enable_save_figure">
<span class="sig-name descname"><span class="pre">enable_save_figure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_path</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/base_env_manager.html#BaseEnvManager.enable_save_figure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.BaseEnvManager.enable_save_figure" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Enable a specific env to save figure (e.g. environment statistics or episode return curve).</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>figure_path (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>): The file directory path for all environments to save figures.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManager.enable_save_replay">
<span class="sig-name descname"><span class="pre">enable_save_replay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">replay_path</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/base_env_manager.html#BaseEnvManager.enable_save_replay"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.BaseEnvManager.enable_save_replay" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Enable all environments to save replay video after each episode terminates.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>replay_path (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[List[str],</span> <span class="pre">str]</span></code>): List of paths for each environment;                 Or one path for all environments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManager.env_num">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">env_num</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#ding.envs.BaseEnvManager.env_num" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">env_num</span></code> is the number of sub-environments in env manager.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>env_num (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): The number of sub-environments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManager.env_ref">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">env_ref</span></span><em class="property"><span class="pre">:</span> <a class="reference internal" href="#ding.envs.BaseEnv" title="ding.envs.env.base_env.BaseEnv"><span class="pre">ding.envs.env.base_env.BaseEnv</span></a></em><a class="headerlink" href="#ding.envs.BaseEnvManager.env_ref" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">env_ref</span></code> is used to acquire some common attributes of env, like obs_shape and act_shape.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>env_ref (<a class="reference internal" href="#ding.envs.BaseEnv" title="ding.envs.BaseEnv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseEnv</span></code></a>): The reference of sub-environment.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManager.launch">
<span class="sig-name descname"><span class="pre">launch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reset_param</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/base_env_manager.html#BaseEnvManager.launch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.BaseEnvManager.launch" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Launch the env manager, instantiate the sub-environments and set up the environments and their parameters.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>reset_param (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Optional[Dict]</span></code>): A dict of reset parameters for each environment, key is the env_id,                 value is the corresponding reset parameter, defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManager.method_name_list">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">method_name_list</span></span><em class="property"><span class="pre">:</span> <span class="pre">list</span></em><a class="headerlink" href="#ding.envs.BaseEnvManager.method_name_list" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The public methods list of sub-environments that can be directly called from the env manager level. Other             methods and attributes will be accessed with the <code class="docutils literal notranslate"><span class="pre">__getattr__</span></code> method.
Methods defined in this list can be regarded as the vectorized extension of methods in sub-environments.
Sub-class of <code class="docutils literal notranslate"><span class="pre">BaseEnvManager</span></code> can override this method to add more methods.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>method_name_list (<code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code>): The public methods list of sub-environments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManager.observation_space">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">observation_space</span></span><em class="property"><span class="pre">:</span> <span class="pre">gym.spaces.Space</span></em><a class="headerlink" href="#ding.envs.BaseEnvManager.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">observation_space</span></code> is the observation space of sub-environment, following the format of gym.spaces.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>observation_space (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.spaces.Space</span></code>): The observation space of sub-environment.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManager.ready_imgs">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">ready_imgs</span></span><em class="property"><span class="pre">:</span> <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ding.envs.BaseEnvManager.ready_imgs" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Sometimes, we need to render the envs, this function is used to get the next ready renderd frame and             corresponding env id.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>render_mode (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Optional[str]</span></code>): The render mode, can be ‘rgb_array’ or ‘depth_array’, which follows                 the definition in the <code class="docutils literal notranslate"><span class="pre">render</span></code> function of <code class="docutils literal notranslate"><span class="pre">ding.utils</span></code> .</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>ready_imgs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">np.ndarray]</span></code>): A dict with env_id keys and rendered frames.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManager.ready_obs">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">ready_obs</span></span><em class="property"><span class="pre">:</span> <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ding.envs.BaseEnvManager.ready_obs" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Overview:</dt><dd><p>Get the ready (next) observation, which is a special design to unify both aysnc/sync env manager.
For each interaction between policy and env, the policy will input the ready_obs and output the action.
Then the env_manager will <code class="docutils literal notranslate"><span class="pre">step</span></code> with the action and prepare the next ready_obs.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>ready_obs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>): A dict with env_id keys and observation values.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stacked_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">obs</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">action</span> <span class="o">=</span> <span class="n">policy</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>  <span class="c1"># here policy inputs np obs and outputs np action</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">action</span> <span class="o">=</span> <span class="p">{</span><span class="n">env_id</span><span class="p">:</span> <span class="n">a</span> <span class="k">for</span> <span class="n">env_id</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">obs</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">action</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">timesteps</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManager.ready_obs_id">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">ready_obs_id</span></span><em class="property"><span class="pre">:</span> <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ding.envs.BaseEnvManager.ready_obs_id" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the ready (next) observation id, which is a special design to unify both aysnc/sync env manager.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>ready_obs_id (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[int]</span></code>): A list of env_ids for ready observations.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManager.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reset_param</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/base_env_manager.html#BaseEnvManager.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.BaseEnvManager.reset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Forcely reset the sub-environments their corresponding parameters. Because in env manager all the             sub-environments usually are reset automatically as soon as they are done, this method is only called when             the caller must forcely reset all the sub-environments, such as in evaluation.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>reset_param (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code>): Dict of reset parameters for each environment, key is the env_id,                 value is the corresponding reset parameters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManager.reward_shaping">
<span class="sig-name descname"><span class="pre">reward_shaping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transitions</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/base_env_manager.html#BaseEnvManager.reward_shaping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.BaseEnvManager.reward_shaping" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Execute reward shaping for a specific environment, which is often called when a episode terminates.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env_id (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): The id of the environment to be shaped.</p></li>
<li><p>transitions (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[dict]</span></code>): The transition data list of the environment to be shaped.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>transitions (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[dict]</span></code>): The shaped transition data list.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManager.reward_space">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">reward_space</span></span><em class="property"><span class="pre">:</span> <span class="pre">gym.spaces.Space</span></em><a class="headerlink" href="#ding.envs.BaseEnvManager.reward_space" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">reward_space</span></code> is the reward space of sub-environment, following the format of gym.spaces.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>reward_space (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.spaces.Space</span></code>): The reward space of sub-environment.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManager.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic_seed</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/base_env_manager.html#BaseEnvManager.seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.BaseEnvManager.seed" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Set the random seed for each environment.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>seed (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[Dict[int,</span> <span class="pre">int],</span> <span class="pre">List[int],</span> <span class="pre">int]</span></code>): Dict or List of seeds for each environment;                 If only one seed is provided, it will be used in the same way for all environments.</p></li>
<li><p>dynamic_seed (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether to use dynamic seed.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For more details about <code class="docutils literal notranslate"><span class="pre">dynamic_seed</span></code>, please refer to the best practice document of DI-engine             (<a class="reference external" href="../04_best_practice/random_seed.html">en link</a>).</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManager.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actions</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">ding.envs.env.base_env.BaseEnvTimestep</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/base_env_manager.html#BaseEnvManager.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.BaseEnvManager.step" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Overview:</dt><dd><p>Execute env step according to input actions. If some sub-environments are done after this execution,             they will be reset automatically when <code class="docutils literal notranslate"><span class="pre">self._auto_reset</span></code> is True, otherwise they need to be reset when             the caller use the <code class="docutils literal notranslate"><span class="pre">reset</span></code> method of env manager.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>actions (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>): A dict of actions, key is the env_id, value is corresponding action.                 action can be any type, it depends on the env, and the env will handle it. Ususlly, the action is                 a dict of numpy array, and the value is generated by the outer caller like <code class="docutils literal notranslate"><span class="pre">policy</span></code>.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>timesteps (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">BaseEnvTimestep]</span></code>): Each timestep is a <code class="docutils literal notranslate"><span class="pre">BaseEnvTimestep</span></code> object,                 usually including observation, reward, done, info. Some special customized environments will have                 the special timestep definition. The length of timesteps is the same as the length of actions in                 synchronous env manager.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">timesteps</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">env_id</span><span class="p">,</span> <span class="n">timestep</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">timesteps</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">if</span> <span class="n">timestep</span><span class="o">.</span><span class="n">done</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Env </span><span class="si">{}</span><span class="s1"> is done&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env_id</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="baseenvmanagerv2">
<h3>BaseEnvManagerV2<a class="headerlink" href="#baseenvmanagerv2" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManagerV2">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">BaseEnvManagerV2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_fn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">easydict.EasyDict</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_manager/base_env_manager.html#BaseEnvManagerV2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.BaseEnvManagerV2" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Overview:</dt><dd><p>The basic class of env manager to manage multiple vectorized environments. BaseEnvManager define all the
necessary interfaces and derived class must extend this basic class.</p>
<p>The class is implemented by the pseudo-parallelism (i.e. serial) mechanism, therefore, this class is only
used in some tiny environments and for debug purpose.</p>
<p><code class="docutils literal notranslate"><span class="pre">V2</span></code> means this env manager is designed for new task pipeline and interfaces coupled with treetensor.`</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For more details about new task pipeline, please refer to the system document of DI-engine         (<a class="reference external" href="../03_system/index.html">system en link</a>).</p>
</div>
<dl class="simple">
<dt>Interfaces:</dt><dd><p>reset, step, seed, close, enable_save_replay, launch, default_config, reward_shaping, enable_save_figure</p>
</dd>
<dt>Properties:</dt><dd><p>env_num, env_ref, ready_obs, ready_obs_id, ready_imgs, done, closed, method_name_list, observation_space,         action_space, reward_space</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManagerV2.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_fn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">easydict.EasyDict</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ding.envs.BaseEnvManagerV2.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the base env manager with callable the env function and the EasyDict-type config. Here we use
<code class="docutils literal notranslate"><span class="pre">env_fn</span></code> to ensure the lazy initialization of sub-environments, which is benetificial to resource
allocation and parallelism. <code class="docutils literal notranslate"><span class="pre">cfg</span></code> is the merged result between the default config of this class
and user’s config.
This construction function is in lazy-initialization mode, the actual initialization is in <code class="docutils literal notranslate"><span class="pre">launch</span></code>.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env_fn (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[Callable]</span></code>): A list of functions to create <code class="docutils literal notranslate"><span class="pre">env_num</span></code> sub-environments.</p></li>
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>): Final merged config.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For more details about how to merge config, please refer to the system document of DI-engine             (<a class="reference external" href="../03_system/config.html">en link</a>).</p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManagerV2.action_space">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">action_space</span></span><em class="property"><span class="pre">:</span> <span class="pre">gym.spaces.Space</span></em><a class="headerlink" href="#ding.envs.BaseEnvManagerV2.action_space" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">action_space</span></code> is the action space of sub-environment, following the format of gym.spaces.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>action_space (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.spaces.Space</span></code>): The action space of sub-environment.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManagerV2.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ding.envs.BaseEnvManagerV2.close" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Close the env manager and release all the environment resources.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManagerV2.closed">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">closed</span></span><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#ding.envs.BaseEnvManagerV2.closed" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">closed</span></code> is a property that returns whether the env manager is closed.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>closed (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether the env manager is closed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManagerV2.default_config">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">easydict.EasyDict</span></span></span><a class="headerlink" href="#ding.envs.BaseEnvManagerV2.default_config" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the deepcopyed default config of env manager.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>): The default config of env manager.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManagerV2.done">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">done</span></span><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#ding.envs.BaseEnvManagerV2.done" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">done</span></code> is a flag to indicate whether env manager is done, i.e., whether all sub-environments have             executed enough episodes.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>done (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether env manager is done.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManagerV2.enable_save_figure">
<span class="sig-name descname"><span class="pre">enable_save_figure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_path</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ding.envs.BaseEnvManagerV2.enable_save_figure" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Enable a specific env to save figure (e.g. environment statistics or episode return curve).</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>figure_path (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>): The file directory path for all environments to save figures.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManagerV2.enable_save_replay">
<span class="sig-name descname"><span class="pre">enable_save_replay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">replay_path</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ding.envs.BaseEnvManagerV2.enable_save_replay" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Enable all environments to save replay video after each episode terminates.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>replay_path (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[List[str],</span> <span class="pre">str]</span></code>): List of paths for each environment;                 Or one path for all environments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManagerV2.env_num">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">env_num</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#ding.envs.BaseEnvManagerV2.env_num" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">env_num</span></code> is the number of sub-environments in env manager.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>env_num (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): The number of sub-environments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManagerV2.env_ref">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">env_ref</span></span><em class="property"><span class="pre">:</span> <a class="reference internal" href="#ding.envs.BaseEnv" title="ding.envs.env.base_env.BaseEnv"><span class="pre">ding.envs.env.base_env.BaseEnv</span></a></em><a class="headerlink" href="#ding.envs.BaseEnvManagerV2.env_ref" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">env_ref</span></code> is used to acquire some common attributes of env, like obs_shape and act_shape.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>env_ref (<a class="reference internal" href="#ding.envs.BaseEnv" title="ding.envs.BaseEnv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseEnv</span></code></a>): The reference of sub-environment.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManagerV2.launch">
<span class="sig-name descname"><span class="pre">launch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reset_param</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ding.envs.BaseEnvManagerV2.launch" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Launch the env manager, instantiate the sub-environments and set up the environments and their parameters.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>reset_param (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Optional[Dict]</span></code>): A dict of reset parameters for each environment, key is the env_id,                 value is the corresponding reset parameter, defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManagerV2.method_name_list">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">method_name_list</span></span><em class="property"><span class="pre">:</span> <span class="pre">list</span></em><a class="headerlink" href="#ding.envs.BaseEnvManagerV2.method_name_list" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The public methods list of sub-environments that can be directly called from the env manager level. Other             methods and attributes will be accessed with the <code class="docutils literal notranslate"><span class="pre">__getattr__</span></code> method.
Methods defined in this list can be regarded as the vectorized extension of methods in sub-environments.
Sub-class of <code class="docutils literal notranslate"><span class="pre">BaseEnvManager</span></code> can override this method to add more methods.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>method_name_list (<code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code>): The public methods list of sub-environments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManagerV2.observation_space">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">observation_space</span></span><em class="property"><span class="pre">:</span> <span class="pre">gym.spaces.Space</span></em><a class="headerlink" href="#ding.envs.BaseEnvManagerV2.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">observation_space</span></code> is the observation space of sub-environment, following the format of gym.spaces.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>observation_space (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.spaces.Space</span></code>): The observation space of sub-environment.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManagerV2.ready_imgs">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">ready_imgs</span></span><em class="property"><span class="pre">:</span> <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ding.envs.BaseEnvManagerV2.ready_imgs" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Sometimes, we need to render the envs, this function is used to get the next ready renderd frame and             corresponding env id.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>render_mode (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Optional[str]</span></code>): The render mode, can be ‘rgb_array’ or ‘depth_array’, which follows                 the definition in the <code class="docutils literal notranslate"><span class="pre">render</span></code> function of <code class="docutils literal notranslate"><span class="pre">ding.utils</span></code> .</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>ready_imgs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">np.ndarray]</span></code>): A dict with env_id keys and rendered frames.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManagerV2.ready_obs">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">ready_obs</span></span><em class="property"><span class="pre">:</span> <span class="pre">treetensor.numpy.funcs.array</span></em><a class="headerlink" href="#ding.envs.BaseEnvManagerV2.ready_obs" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Overview:</dt><dd><p>Get the ready (next) observation, which is a special design to unify both aysnc/sync env manager.
For each interaction between policy and env, the policy will input the ready_obs and output the action.
Then the env_manager will <code class="docutils literal notranslate"><span class="pre">step</span></code> with the action and prepare the next ready_obs.
For <code class="docutils literal notranslate"><span class="pre">V2</span></code> version, the observation is transformed and packed up into <code class="docutils literal notranslate"><span class="pre">tnp.array</span></code> type, which allows
more convenient operations.</p>
</dd>
<dt>Return:</dt><dd><ul class="simple">
<li><p>ready_obs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">tnp.array</span></code>): A stacked treenumpy-type observation data.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">action</span> <span class="o">=</span> <span class="n">policy</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>  <span class="c1"># here policy inputs treenp obs and output np action</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">timesteps</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManagerV2.ready_obs_id">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">ready_obs_id</span></span><em class="property"><span class="pre">:</span> <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ding.envs.BaseEnvManagerV2.ready_obs_id" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the ready (next) observation id, which is a special design to unify both aysnc/sync env manager.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>ready_obs_id (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[int]</span></code>): A list of env_ids for ready observations.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManagerV2.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reset_param</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ding.envs.BaseEnvManagerV2.reset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Forcely reset the sub-environments their corresponding parameters. Because in env manager all the             sub-environments usually are reset automatically as soon as they are done, this method is only called when             the caller must forcely reset all the sub-environments, such as in evaluation.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>reset_param (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code>): Dict of reset parameters for each environment, key is the env_id,                 value is the corresponding reset parameters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManagerV2.reward_shaping">
<span class="sig-name descname"><span class="pre">reward_shaping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transitions</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#ding.envs.BaseEnvManagerV2.reward_shaping" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Execute reward shaping for a specific environment, which is often called when a episode terminates.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env_id (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): The id of the environment to be shaped.</p></li>
<li><p>transitions (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[dict]</span></code>): The transition data list of the environment to be shaped.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>transitions (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[dict]</span></code>): The shaped transition data list.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManagerV2.reward_space">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">reward_space</span></span><em class="property"><span class="pre">:</span> <span class="pre">gym.spaces.Space</span></em><a class="headerlink" href="#ding.envs.BaseEnvManagerV2.reward_space" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">reward_space</span></code> is the reward space of sub-environment, following the format of gym.spaces.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>reward_space (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.spaces.Space</span></code>): The reward space of sub-environment.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManagerV2.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic_seed</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ding.envs.BaseEnvManagerV2.seed" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Set the random seed for each environment.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>seed (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[Dict[int,</span> <span class="pre">int],</span> <span class="pre">List[int],</span> <span class="pre">int]</span></code>): Dict or List of seeds for each environment;                 If only one seed is provided, it will be used in the same way for all environments.</p></li>
<li><p>dynamic_seed (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether to use dynamic seed.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For more details about <code class="docutils literal notranslate"><span class="pre">dynamic_seed</span></code>, please refer to the best practice document of DI-engine             (<a class="reference external" href="../04_best_practice/random_seed.html">en link</a>).</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.BaseEnvManagerV2.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actions</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">treetensor.numpy.array.ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">treetensor.numpy.array.ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/base_env_manager.html#BaseEnvManagerV2.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.BaseEnvManagerV2.step" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Overview:</dt><dd><p>Execute env step according to input actions. If some sub-environments are done after this execution,             they will be reset automatically by default.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>actions (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[tnp.ndarray]</span></code>): A list of treenumpy-type actions, the value is generated by the                 outer caller like <code class="docutils literal notranslate"><span class="pre">policy</span></code>.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>timesteps (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[tnp.ndarray]</span></code>): A list of timestep, Each timestep is a <code class="docutils literal notranslate"><span class="pre">tnp.ndarray</span></code> object,                 usually including observation, reward, done, info, env_id. Some special environments will have                 the special timestep definition. The length of timesteps is the same as the length of actions in                 synchronous env manager. For the compatibility of treenumpy, here we use <code class="docutils literal notranslate"><span class="pre">make_key_as_identifier</span></code>                 and <code class="docutils literal notranslate"><span class="pre">remove_illegal_item</span></code> functions to modify the original timestep.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">timesteps</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">timestep</span> <span class="ow">in</span> <span class="n">timesteps</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">if</span> <span class="n">timestep</span><span class="o">.</span><span class="n">done</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Env </span><span class="si">{}</span><span class="s1"> is done&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">timestep</span><span class="o">.</span><span class="n">env_id</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="syncsubprocessenvmanager">
<h3>SyncSubprocessEnvManager<a class="headerlink" href="#syncsubprocessenvmanager" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.SyncSubprocessEnvManager">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">SyncSubprocessEnvManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_fn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">easydict.EasyDict</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_manager/subprocess_env_manager.html#SyncSubprocessEnvManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.SyncSubprocessEnvManager" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="ding.envs.SyncSubprocessEnvManager.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_fn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">easydict.EasyDict</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ding.envs.SyncSubprocessEnvManager.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the AsyncSubprocessEnvManager.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env_fn (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[Callable]</span></code>): The function to create environment</p></li>
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>): Config</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>wait_num: for each time the minimum number of env return to gather</p></li>
<li><p>step_wait_timeout: for each time the minimum number of env return to gather</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.SyncSubprocessEnvManager.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ding.envs.SyncSubprocessEnvManager.close" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>CLose the env manager and release all related resources.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.SyncSubprocessEnvManager.default_config">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">easydict.EasyDict</span></span></span><a class="headerlink" href="#ding.envs.SyncSubprocessEnvManager.default_config" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the deepcopyed default config of env manager.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>): The default config of env manager.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.SyncSubprocessEnvManager.enable_save_replay">
<span class="sig-name descname"><span class="pre">enable_save_replay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">replay_path</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ding.envs.SyncSubprocessEnvManager.enable_save_replay" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Set each env’s replay save path.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>replay_path (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[List[str],</span> <span class="pre">str]</span></code>): List of paths for each environment;                 Or one path for all environments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.SyncSubprocessEnvManager.launch">
<span class="sig-name descname"><span class="pre">launch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reset_param</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ding.envs.SyncSubprocessEnvManager.launch" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Set up the environments and their parameters.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>reset_param (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Optional[Dict]</span></code>): Dict of reset parameters for each environment, key is the env_id,                 value is the cooresponding reset parameters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.SyncSubprocessEnvManager.ready_imgs">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">ready_imgs</span></span><em class="property"><span class="pre">:</span> <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ding.envs.SyncSubprocessEnvManager.ready_imgs" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the next renderd frames.</p>
</dd>
<dt>Return:</dt><dd><p>A dictionary with rendered frames and their environment IDs.</p>
</dd>
<dt>Note:</dt><dd><p>The rendered frames are returned in np.ndarray.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.SyncSubprocessEnvManager.ready_obs">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">ready_obs</span></span><em class="property"><span class="pre">:</span> <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ding.envs.SyncSubprocessEnvManager.ready_obs" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Overview:</dt><dd><p>Get the next observations.</p>
</dd>
<dt>Return:</dt><dd><p>A dictionary with observations and their environment IDs.</p>
</dd>
<dt>Note:</dt><dd><p>The observations are returned in np.ndarray.</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span>    <span class="n">obs_dict</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">actions_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">env_id</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span> <span class="k">for</span> <span class="n">env_id</span><span class="p">,</span> <span class="n">obs</span> <span class="ow">in</span> <span class="n">obs_dict</span><span class="o">.</span><span class="n">items</span><span class="p">())}</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.SyncSubprocessEnvManager.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reset_param</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ding.envs.SyncSubprocessEnvManager.reset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset the environments their parameters.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>reset_param (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code>): Dict of reset parameters for each environment, key is the env_id,                 value is the cooresponding reset parameters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.SyncSubprocessEnvManager.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic_seed</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ding.envs.SyncSubprocessEnvManager.seed" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Set the random seed for each environment.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>seed (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[Dict[int,</span> <span class="pre">int],</span> <span class="pre">List[int],</span> <span class="pre">int]</span></code>): Dict or List of seeds for each environment;                 If only one seed is provided, it will be used in the same way for all environments.</p></li>
<li><p>dynamic_seed (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether to use dynamic seed.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For more details about <code class="docutils literal notranslate"><span class="pre">dynamic_seed</span></code>, please refer to the best practice document of DI-engine             (<a class="reference external" href="../04_best_practice/random_seed.html">en link</a>).</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.SyncSubprocessEnvManager.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actions</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">collections.namedtuple</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/subprocess_env_manager.html#SyncSubprocessEnvManager.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.SyncSubprocessEnvManager.step" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Overview:</dt><dd><p>Step all environments. Reset an env if done.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>actions (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>): {env_id: action}</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>timesteps (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">namedtuple]</span></code>): {env_id: timestep}. Timestep is a                 <code class="docutils literal notranslate"><span class="pre">BaseEnvTimestep</span></code> tuple with observation, reward, done, env_info.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span>    <span class="n">actions_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">env_id</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span> <span class="k">for</span> <span class="n">env_id</span><span class="p">,</span> <span class="n">obs</span> <span class="ow">in</span> <span class="n">obs_dict</span><span class="o">.</span><span class="n">items</span><span class="p">())}</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">timesteps</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">actions_dict</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">env_id</span><span class="p">,</span> <span class="n">timestep</span> <span class="ow">in</span> <span class="n">timesteps</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">pass</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The env_id that appears in <code class="docutils literal notranslate"><span class="pre">actions</span></code> will also be returned in <code class="docutils literal notranslate"><span class="pre">timesteps</span></code>.</p></li>
<li><p>Each environment is run by a subprocess separately. Once an environment is done, it is reset immediately.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.SyncSubprocessEnvManager.worker_fn">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">worker_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">multiprocessing.connection.Connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">multiprocessing.connection.Connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_fn_wrapper</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">ding.utils.compression_helper.CloudPickleWrapper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_buffer</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">ding.data.shm_buffer.ShmBuffer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method_name_list</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_inplace</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ding.envs.SyncSubprocessEnvManager.worker_fn" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Subprocess’s target function to run.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.SyncSubprocessEnvManager.worker_fn_robust">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">worker_fn_robust</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">child</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_fn_wrapper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_buffer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method_name_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ding.envs.SyncSubprocessEnvManager.worker_fn_robust" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>A more robust version of subprocess’s target function to run. Used by default.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="subprocessenvmanagerv2">
<h3>SubprocessEnvManagerV2<a class="headerlink" href="#subprocessenvmanagerv2" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.SubprocessEnvManagerV2">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">SubprocessEnvManagerV2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_fn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">easydict.EasyDict</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_manager/subprocess_env_manager.html#SubprocessEnvManagerV2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.SubprocessEnvManagerV2" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>SyncSubprocessEnvManager for new task pipeline and interfaces coupled with treetensor.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.SubprocessEnvManagerV2.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_fn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">easydict.EasyDict</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ding.envs.SubprocessEnvManagerV2.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the AsyncSubprocessEnvManager.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env_fn (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[Callable]</span></code>): The function to create environment</p></li>
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>): Config</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>wait_num: for each time the minimum number of env return to gather</p></li>
<li><p>step_wait_timeout: for each time the minimum number of env return to gather</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.SubprocessEnvManagerV2.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ding.envs.SubprocessEnvManagerV2.close" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>CLose the env manager and release all related resources.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.SubprocessEnvManagerV2.default_config">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">easydict.EasyDict</span></span></span><a class="headerlink" href="#ding.envs.SubprocessEnvManagerV2.default_config" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the deepcopyed default config of env manager.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>): The default config of env manager.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.SubprocessEnvManagerV2.enable_save_replay">
<span class="sig-name descname"><span class="pre">enable_save_replay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">replay_path</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ding.envs.SubprocessEnvManagerV2.enable_save_replay" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Set each env’s replay save path.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>replay_path (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[List[str],</span> <span class="pre">str]</span></code>): List of paths for each environment;                 Or one path for all environments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.SubprocessEnvManagerV2.launch">
<span class="sig-name descname"><span class="pre">launch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reset_param</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ding.envs.SubprocessEnvManagerV2.launch" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Set up the environments and their parameters.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>reset_param (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Optional[Dict]</span></code>): Dict of reset parameters for each environment, key is the env_id,                 value is the cooresponding reset parameters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.SubprocessEnvManagerV2.ready_imgs">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">ready_imgs</span></span><em class="property"><span class="pre">:</span> <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ding.envs.SubprocessEnvManagerV2.ready_imgs" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the next renderd frames.</p>
</dd>
<dt>Return:</dt><dd><p>A dictionary with rendered frames and their environment IDs.</p>
</dd>
<dt>Note:</dt><dd><p>The rendered frames are returned in np.ndarray.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.SubprocessEnvManagerV2.ready_obs">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">ready_obs</span></span><em class="property"><span class="pre">:</span> <span class="pre">treetensor.numpy.funcs.array</span></em><a class="headerlink" href="#ding.envs.SubprocessEnvManagerV2.ready_obs" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Overview:</dt><dd><p>Get the ready (next) observation in <code class="docutils literal notranslate"><span class="pre">tnp.array</span></code> type, which is uniform for both async/sync scenarios.</p>
</dd>
<dt>Return:</dt><dd><ul class="simple">
<li><p>ready_obs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">tnp.array</span></code>): A stacked treenumpy-type observation data.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">action</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>  <span class="c1"># model input np obs and output np action</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">timesteps</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.SubprocessEnvManagerV2.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reset_param</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ding.envs.SubprocessEnvManagerV2.reset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset the environments their parameters.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>reset_param (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code>): Dict of reset parameters for each environment, key is the env_id,                 value is the cooresponding reset parameters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.SubprocessEnvManagerV2.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic_seed</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ding.envs.SubprocessEnvManagerV2.seed" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Set the random seed for each environment.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>seed (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[Dict[int,</span> <span class="pre">int],</span> <span class="pre">List[int],</span> <span class="pre">int]</span></code>): Dict or List of seeds for each environment;                 If only one seed is provided, it will be used in the same way for all environments.</p></li>
<li><p>dynamic_seed (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether to use dynamic seed.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For more details about <code class="docutils literal notranslate"><span class="pre">dynamic_seed</span></code>, please refer to the best practice document of DI-engine             (<a class="reference external" href="../04_best_practice/random_seed.html">en link</a>).</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.SubprocessEnvManagerV2.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actions</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">treetensor.numpy.array.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">treetensor.numpy.array.ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">treetensor.numpy.array.ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/subprocess_env_manager.html#SubprocessEnvManagerV2.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.SubprocessEnvManagerV2.step" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Execute env step according to input actions. And reset an env if done.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>actions (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[List[tnp.ndarray],</span> <span class="pre">tnp.ndarray]</span></code>): actions came from outer caller like policy.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>timesteps (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[tnp.ndarray]</span></code>): Each timestep is a tnp.array with observation, reward, done,                 info, env_id.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.SubprocessEnvManagerV2.worker_fn">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">worker_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">multiprocessing.connection.Connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">multiprocessing.connection.Connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_fn_wrapper</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">ding.utils.compression_helper.CloudPickleWrapper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_buffer</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">ding.data.shm_buffer.ShmBuffer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method_name_list</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_inplace</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ding.envs.SubprocessEnvManagerV2.worker_fn" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Subprocess’s target function to run.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.SubprocessEnvManagerV2.worker_fn_robust">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">worker_fn_robust</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">child</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_fn_wrapper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_buffer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method_name_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ding.envs.SubprocessEnvManagerV2.worker_fn_robust" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>A more robust version of subprocess’s target function to run. Used by default.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="asyncsubprocessenvmanager">
<h3>AsyncSubprocessEnvManager<a class="headerlink" href="#asyncsubprocessenvmanager" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.AsyncSubprocessEnvManager">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">AsyncSubprocessEnvManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_fn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">easydict.EasyDict</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_manager/subprocess_env_manager.html#AsyncSubprocessEnvManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.AsyncSubprocessEnvManager" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Create an AsyncSubprocessEnvManager to manage multiple environments.
Each Environment is run by a respective subprocess.</p>
</dd>
<dt>Interfaces:</dt><dd><p>seed, launch, ready_obs, step, reset, active_env</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.AsyncSubprocessEnvManager.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_fn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">easydict.EasyDict</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/subprocess_env_manager.html#AsyncSubprocessEnvManager.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.AsyncSubprocessEnvManager.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the AsyncSubprocessEnvManager.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env_fn (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[Callable]</span></code>): The function to create environment</p></li>
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>): Config</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>wait_num: for each time the minimum number of env return to gather</p></li>
<li><p>step_wait_timeout: for each time the minimum number of env return to gather</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.AsyncSubprocessEnvManager.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/subprocess_env_manager.html#AsyncSubprocessEnvManager.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.AsyncSubprocessEnvManager.close" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>CLose the env manager and release all related resources.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.AsyncSubprocessEnvManager.default_config">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">easydict.EasyDict</span></span></span><a class="headerlink" href="#ding.envs.AsyncSubprocessEnvManager.default_config" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Return the deepcopyed default config of env manager.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>): The default config of env manager.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.AsyncSubprocessEnvManager.enable_save_replay">
<span class="sig-name descname"><span class="pre">enable_save_replay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">replay_path</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/subprocess_env_manager.html#AsyncSubprocessEnvManager.enable_save_replay"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.AsyncSubprocessEnvManager.enable_save_replay" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Set each env’s replay save path.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>replay_path (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[List[str],</span> <span class="pre">str]</span></code>): List of paths for each environment;                 Or one path for all environments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.AsyncSubprocessEnvManager.launch">
<span class="sig-name descname"><span class="pre">launch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reset_param</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/subprocess_env_manager.html#AsyncSubprocessEnvManager.launch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.AsyncSubprocessEnvManager.launch" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Set up the environments and their parameters.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>reset_param (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Optional[Dict]</span></code>): Dict of reset parameters for each environment, key is the env_id,                 value is the cooresponding reset parameters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.AsyncSubprocessEnvManager.ready_imgs">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">ready_imgs</span></span><em class="property"><span class="pre">:</span> <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ding.envs.AsyncSubprocessEnvManager.ready_imgs" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get the next renderd frames.</p>
</dd>
<dt>Return:</dt><dd><p>A dictionary with rendered frames and their environment IDs.</p>
</dd>
<dt>Note:</dt><dd><p>The rendered frames are returned in np.ndarray.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.AsyncSubprocessEnvManager.ready_obs">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">ready_obs</span></span><em class="property"><span class="pre">:</span> <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ding.envs.AsyncSubprocessEnvManager.ready_obs" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Overview:</dt><dd><p>Get the next observations.</p>
</dd>
<dt>Return:</dt><dd><p>A dictionary with observations and their environment IDs.</p>
</dd>
<dt>Note:</dt><dd><p>The observations are returned in np.ndarray.</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span>    <span class="n">obs_dict</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">actions_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">env_id</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span> <span class="k">for</span> <span class="n">env_id</span><span class="p">,</span> <span class="n">obs</span> <span class="ow">in</span> <span class="n">obs_dict</span><span class="o">.</span><span class="n">items</span><span class="p">())}</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.AsyncSubprocessEnvManager.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reset_param</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/subprocess_env_manager.html#AsyncSubprocessEnvManager.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.AsyncSubprocessEnvManager.reset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset the environments their parameters.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>reset_param (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code>): Dict of reset parameters for each environment, key is the env_id,                 value is the cooresponding reset parameters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.AsyncSubprocessEnvManager.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic_seed</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ding.envs.AsyncSubprocessEnvManager.seed" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Set the random seed for each environment.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>seed (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[Dict[int,</span> <span class="pre">int],</span> <span class="pre">List[int],</span> <span class="pre">int]</span></code>): Dict or List of seeds for each environment;                 If only one seed is provided, it will be used in the same way for all environments.</p></li>
<li><p>dynamic_seed (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether to use dynamic seed.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For more details about <code class="docutils literal notranslate"><span class="pre">dynamic_seed</span></code>, please refer to the best practice document of DI-engine             (<a class="reference external" href="../04_best_practice/random_seed.html">en link</a>).</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.AsyncSubprocessEnvManager.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actions</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">collections.namedtuple</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/subprocess_env_manager.html#AsyncSubprocessEnvManager.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.AsyncSubprocessEnvManager.step" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Overview:</dt><dd><p>Step all environments. Reset an env if done.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>actions (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>): {env_id: action}</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>timesteps (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">namedtuple]</span></code>): {env_id: timestep}. Timestep is a                 <code class="docutils literal notranslate"><span class="pre">BaseEnvTimestep</span></code> tuple with observation, reward, done, env_info.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span>    <span class="n">actions_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">env_id</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span> <span class="k">for</span> <span class="n">env_id</span><span class="p">,</span> <span class="n">obs</span> <span class="ow">in</span> <span class="n">obs_dict</span><span class="o">.</span><span class="n">items</span><span class="p">())}</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">timesteps</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">actions_dict</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">env_id</span><span class="p">,</span> <span class="n">timestep</span> <span class="ow">in</span> <span class="n">timesteps</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">pass</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.AsyncSubprocessEnvManager.worker_fn">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">worker_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">multiprocessing.connection.Connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">multiprocessing.connection.Connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_fn_wrapper</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">ding.utils.compression_helper.CloudPickleWrapper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_buffer</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">ding.data.shm_buffer.ShmBuffer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method_name_list</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_inplace</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/subprocess_env_manager.html#AsyncSubprocessEnvManager.worker_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.AsyncSubprocessEnvManager.worker_fn" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Subprocess’s target function to run.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.AsyncSubprocessEnvManager.worker_fn_robust">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">worker_fn_robust</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">child</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_fn_wrapper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_buffer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method_name_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/subprocess_env_manager.html#AsyncSubprocessEnvManager.worker_fn_robust"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.AsyncSubprocessEnvManager.worker_fn_robust" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>A more robust version of subprocess’s target function to run. Used by default.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="gymvectorenvmanager">
<h3>GymVectorEnvManager<a class="headerlink" href="#gymvectorenvmanager" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.GymVectorEnvManager">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">GymVectorEnvManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_fn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">easydict.EasyDict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_manager/gym_vector_env_manager.html#GymVectorEnvManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.GymVectorEnvManager" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Create an GymVectorEnvManager to manage multiple environments.
Each Environment is run by a respective subprocess.</p>
</dd>
<dt>Interfaces:</dt><dd><p>seed, ready_obs, step, reset, close</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.GymVectorEnvManager.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_fn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">easydict.EasyDict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/gym_vector_env_manager.html#GymVectorEnvManager.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.GymVectorEnvManager.__init__" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">env_fn</span></code> must create gym-type environment instance, which may different DI-engine environment.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.GymVectorEnvManager.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/gym_vector_env_manager.html#GymVectorEnvManager.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.GymVectorEnvManager.close" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Release the environment resources
Since not calling super.__init__, no need to release BaseEnvManager’s resources</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ding.envs.GymVectorEnvManager.ready_obs">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">ready_obs</span></span><em class="property"><span class="pre">:</span> <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ding.envs.GymVectorEnvManager.ready_obs" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Overview:</dt><dd><p>Get the ready (next) observation, which is a special design to unify both aysnc/sync env manager.
For each interaction between policy and env, the policy will input the ready_obs and output the action.
Then the env_manager will <code class="docutils literal notranslate"><span class="pre">step</span></code> with the action and prepare the next ready_obs.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>ready_obs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>): A dict with env_id keys and observation values.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">ready_obs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stacked_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">obs</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">action</span> <span class="o">=</span> <span class="n">policy</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>  <span class="c1"># here policy inputs np obs and outputs np action</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">action</span> <span class="o">=</span> <span class="p">{</span><span class="n">env_id</span><span class="p">:</span> <span class="n">a</span> <span class="k">for</span> <span class="n">env_id</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">obs</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">action</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">timesteps</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.GymVectorEnvManager.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reset_param</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/gym_vector_env_manager.html#GymVectorEnvManager.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.GymVectorEnvManager.reset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Forcely reset the sub-environments their corresponding parameters. Because in env manager all the             sub-environments usually are reset automatically as soon as they are done, this method is only called when             the caller must forcely reset all the sub-environments, such as in evaluation.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>reset_param (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List</span></code>): Dict of reset parameters for each environment, key is the env_id,                 value is the corresponding reset parameters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.GymVectorEnvManager.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic_seed</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/gym_vector_env_manager.html#GymVectorEnvManager.seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.GymVectorEnvManager.seed" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Set the random seed for each environment.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>seed (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[Dict[int,</span> <span class="pre">int],</span> <span class="pre">List[int],</span> <span class="pre">int]</span></code>): Dict or List of seeds for each environment;                 If only one seed is provided, it will be used in the same way for all environments.</p></li>
<li><p>dynamic_seed (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether to use dynamic seed.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For more details about <code class="docutils literal notranslate"><span class="pre">dynamic_seed</span></code>, please refer to the best practice document of DI-engine             (<a class="reference external" href="../04_best_practice/random_seed.html">en link</a>).</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.GymVectorEnvManager.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actions</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">collections.namedtuple</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/ding/envs/env_manager/gym_vector_env_manager.html#GymVectorEnvManager.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.GymVectorEnvManager.step" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Overview:</dt><dd><p>Execute env step according to input actions. If some sub-environments are done after this execution,             they will be reset automatically when <code class="docutils literal notranslate"><span class="pre">self._auto_reset</span></code> is True, otherwise they need to be reset when             the caller use the <code class="docutils literal notranslate"><span class="pre">reset</span></code> method of env manager.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>actions (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">Any]</span></code>): A dict of actions, key is the env_id, value is corresponding action.                 action can be any type, it depends on the env, and the env will handle it. Ususlly, the action is                 a dict of numpy array, and the value is generated by the outer caller like <code class="docutils literal notranslate"><span class="pre">policy</span></code>.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>timesteps (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">BaseEnvTimestep]</span></code>): Each timestep is a <code class="docutils literal notranslate"><span class="pre">BaseEnvTimestep</span></code> object,                 usually including observation, reward, done, info. Some special customized environments will have                 the special timestep definition. The length of timesteps is the same as the length of actions in                 synchronous env manager.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">timesteps</span> <span class="o">=</span> <span class="n">env_manager</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">env_id</span><span class="p">,</span> <span class="n">timestep</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">timesteps</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">if</span> <span class="n">timestep</span><span class="o">.</span><span class="n">done</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Env </span><span class="si">{}</span><span class="s1"> is done&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env_id</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="env-wrapper">
<h2>Env Wrapper<a class="headerlink" href="#env-wrapper" title="Permalink to this headline">¶</a></h2>
<p>Please refer to <code class="docutils literal notranslate"><span class="pre">ding/envs/env_wrappers</span></code> for more details.</p>
<section id="create-env-wrapper">
<h3>create_env_wrapper<a class="headerlink" href="#create-env-wrapper" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="ding.envs.create_env_wrapper">
<span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">create_env_wrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_wrapper_cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">easydict.EasyDict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">gym.core.Wrapper</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#create_env_wrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.create_env_wrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Create an environment wrapper according to the environment wrapper configuration and the environment instance.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): The environment instance to be wrapped.</p></li>
<li><p>env_wrapper_cfg (<code class="xref py py-obj docutils literal notranslate"><span class="pre">EasyDict</span></code>): The configuration for the environment wrapper.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Wrapper</span></code>): The wrapped environment instance.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="update-shape">
<h3>update_shape<a class="headerlink" href="#update-shape" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="ding.envs.update_shape">
<span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">update_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_shape</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_shape</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rew_shape</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrapper_names</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#update_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.update_shape" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Get new shapes of observation, action, and reward given the wrapper.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>obs_shape (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>): The original shape of observation.</p></li>
<li><p>act_shape (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>): The original shape of action.</p></li>
<li><p>rew_shape (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>): The original shape of reward.</p></li>
<li><p>wrapper_names (<code class="xref py py-obj docutils literal notranslate"><span class="pre">List[str]</span></code>): The names of the wrappers.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>obs_shape (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>): The new shape of observation.</p></li>
<li><p>act_shape (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>): The new shape of action.</p></li>
<li><p>rew_shape (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>): The new shape of reward.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="noopresetwrapper">
<h3>NoopResetWrapper<a class="headerlink" href="#noopresetwrapper" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.NoopResetWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">NoopResetWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noop_max</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#NoopResetWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.NoopResetWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Sample initial states by taking random number of no-ops on reset.  No-op is assumed to be action 0.</p>
</dd>
<dt>Interfaces:</dt><dd><p>__init__, reset</p>
</dd>
<dt>Properties:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): the environment to wrap.</p></li>
<li><p>noop_max (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): the maximum value of no-ops to run.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.NoopResetWrapper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noop_max</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#NoopResetWrapper.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.NoopResetWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the NoopResetWrapper.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): the environment to wrap.</p></li>
<li><p>noop_max (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): the maximum value of no-ops to run. Defaults to 30.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.NoopResetWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#NoopResetWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.NoopResetWrapper.reset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Resets the state of the environment and returns an initial observation,
after taking a random number of no-ops.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>observation (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>): The initial observation after no-ops.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="maxandskipwrapper">
<h3>MaxAndSkipWrapper<a class="headerlink" href="#maxandskipwrapper" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.MaxAndSkipWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">MaxAndSkipWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#MaxAndSkipWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.MaxAndSkipWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Wraps the environment to return only every <code class="docutils literal notranslate"><span class="pre">skip</span></code>-th frame (frameskipping)        using most recent raw observations (for max pooling across time steps).</p>
</dd>
<dt>Interfaces:</dt><dd><p>__init__, step</p>
</dd>
<dt>Properties:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): The environment to wrap.</p></li>
<li><p>skip (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): Number of <code class="docutils literal notranslate"><span class="pre">skip</span></code>-th frame. Defaults to 4.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.MaxAndSkipWrapper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#MaxAndSkipWrapper.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.MaxAndSkipWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the MaxAndSkipWrapper.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): The environment to wrap.</p></li>
<li><p>skip (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): Number of <code class="docutils literal notranslate"><span class="pre">skip</span></code>-th frame. Defaults to 4.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.MaxAndSkipWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#MaxAndSkipWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.MaxAndSkipWrapper.step" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Take the given action and repeat it for a specified number of steps.             The rewards are summed up and the maximum frame over the last observations is returned.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>action (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>): The action to repeat.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>max_frame (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.array</span></code>): Max over last observations</p></li>
<li><p>total_reward (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>): Sum of rewards after previous action.</p></li>
<li><p>done (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Bool</span></code>): Whether the episode has ended.</p></li>
<li><p>info (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict</span></code>): Contains auxiliary diagnostic information (helpful for                  debugging, and sometimes learning)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="fireresetwrapper">
<h3>FireResetWrapper<a class="headerlink" href="#fireresetwrapper" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.FireResetWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">FireResetWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#FireResetWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.FireResetWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>This wrapper takes a fire action at environment reset.
Related discussion: <a class="reference external" href="https://github.com/openai/baselines/issues/240">https://github.com/openai/baselines/issues/240</a></p>
</dd>
<dt>Interfaces:</dt><dd><p>__init__, reset</p>
</dd>
<dt>Properties:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): The environment to wrap.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.FireResetWrapper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#FireResetWrapper.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.FireResetWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the FireResetWrapper. Assume that the second action of the environment
is ‘FIRE’ and there are at least three actions.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): The environment to wrap.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.FireResetWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#FireResetWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.FireResetWrapper.reset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Resets the state of the environment and executes a fire action, i.e. reset with action 1.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>observation (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): New observation after reset and fire action.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="episodiclifewrapper">
<h3>EpisodicLifeWrapper<a class="headerlink" href="#episodiclifewrapper" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.EpisodicLifeWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">EpisodicLifeWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#EpisodicLifeWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.EpisodicLifeWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>This wrapper makes end-of-life equivalent to end-of-episode, but only resets on
true game over. This helps in better value estimation.</p>
</dd>
<dt>Interfaces:</dt><dd><p>__init__, step, reset</p>
</dd>
<dt>Properties:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): The environment to wrap.</p></li>
<li><p>lives (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): The current number of lives.</p></li>
<li><p>was_real_done (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether the last episode was ended due to game over.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.EpisodicLifeWrapper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#EpisodicLifeWrapper.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.EpisodicLifeWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the EpisodicLifeWrapper, setting lives to 0 and was_real_done to True.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): The environment to wrap.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.EpisodicLifeWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span> </span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#EpisodicLifeWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.EpisodicLifeWrapper.step" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Execute the given action in the environment, update properties based on the new
state and return the new observation, reward, done status and info.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>action (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>): The action to execute in the environment.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>observation (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): Normalized observation after the action execution and updated <cite>self.rms</cite>.</p></li>
<li><p>reward (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>): Amount of reward returned after the action execution.</p></li>
<li><dl class="simple">
<dt>done (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether the episode has ended, in which case further step() calls will return</dt><dd><p>undefined results.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>info (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict</span></code>): Contains auxiliary diagnostic information (helpful for debugging, and</dt><dd><p>sometimes learning).</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="cliprewardwrapper">
<h3>ClipRewardWrapper<a class="headerlink" href="#cliprewardwrapper" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.ClipRewardWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">ClipRewardWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#ClipRewardWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.ClipRewardWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The ClipRewardWrapper class is a gym reward wrapper that clips the reward to {-1, 0, +1} based on its sign.
This can be used to normalize the scale of the rewards in reinforcement learning algorithms.</p>
</dd>
<dt>Interfaces:</dt><dd><p>__init__, reward</p>
</dd>
<dt>Properties:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): the environment to wrap.</p></li>
<li><p>reward_range (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Tuple[int,</span> <span class="pre">int]</span></code>): the range of the reward values after clipping.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.ClipRewardWrapper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#ClipRewardWrapper.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.ClipRewardWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the ClipRewardWrapper class.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): the environment to wrap.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.ClipRewardWrapper.reward">
<span class="sig-name descname"><span class="pre">reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reward</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#ClipRewardWrapper.reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.ClipRewardWrapper.reward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Clip the reward to {-1, 0, +1} based on its sign. Note: np.sign(0) == 0.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>reward (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>): the original reward.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>reward (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>): the clipped reward.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="framestackwrapper">
<h3>FrameStackWrapper<a class="headerlink" href="#framestackwrapper" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.FrameStackWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">FrameStackWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_frames</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#FrameStackWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.FrameStackWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>FrameStackWrapper is a gym environment wrapper that stacks the latest n frames (generally 4 in Atari)
as a single observation. It is commonly used in environments where the observation is an image,
and consecutive frames provide useful temporal information for the agent.</p>
</dd>
<dt>Interfaces:</dt><dd><p>__init__, reset, step, _get_ob</p>
</dd>
<dt>Properties:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): The environment to wrap.</p></li>
<li><p>n_frames (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): The number of frames to stack.</p></li>
<li><p>frames (<code class="xref py py-obj docutils literal notranslate"><span class="pre">collections.deque</span></code>): A queue that holds the most recent frames.</p></li>
<li><p>observation_space (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Space</span></code>): The space of the stacked observations.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.FrameStackWrapper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_frames</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#FrameStackWrapper.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.FrameStackWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the FrameStackWrapper. This process includes setting up the environment to wrap,
the number of frames to stack, and the observation space.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): The environment to wrap.</p></li>
<li><p>n_frame (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): The number of frames to stack.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.FrameStackWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#FrameStackWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.FrameStackWrapper.reset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset the environment and initialize frames with the initial observation.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>init_obs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): The stacked initial observations.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.FrameStackWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#FrameStackWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.FrameStackWrapper.step" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Perform a step in the environment with the given action, append the returned observation
to frames, and return the stacked observations.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>action (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>): The action to perform a step with.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>self._get_ob() (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): The stacked observations.</p></li>
<li><p>reward (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>): The amount of reward returned after the previous action.</p></li>
<li><p>done (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether the episode has ended, in which case further step() calls will return
undefined results.</p></li>
<li><p>info (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>): Contains auxiliary diagnostic information (helpful for debugging,
and sometimes learning).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="scaledfloatframewrapper">
<h3>ScaledFloatFrameWrapper<a class="headerlink" href="#scaledfloatframewrapper" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.ScaledFloatFrameWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">ScaledFloatFrameWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#ScaledFloatFrameWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.ScaledFloatFrameWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The ScaledFloatFrameWrapper normalizes observations to between 0 and 1.</p>
</dd>
<dt>Interfaces:</dt><dd><p>__init__, observation</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.ScaledFloatFrameWrapper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#ScaledFloatFrameWrapper.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.ScaledFloatFrameWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the ScaledFloatFrameWrapper, setting the scale and bias for normalization.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): the environment to wrap.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.ScaledFloatFrameWrapper.observation">
<span class="sig-name descname"><span class="pre">observation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#ScaledFloatFrameWrapper.observation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.ScaledFloatFrameWrapper.observation" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Scale the observation to be within the range [0, 1].</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>observation (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): the original observation.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>scaled_observation (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): the scaled observation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="warpframewrapper">
<h3>WarpFrameWrapper<a class="headerlink" href="#warpframewrapper" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.WarpFrameWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">WarpFrameWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">84</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#WarpFrameWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.WarpFrameWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The WarpFrameWrapper class is a gym observation wrapper that resizes
the frame of an environment observation to a specified size (default is 84x84).
This is often used in the preprocessing pipeline of observations in reinforcement learning,
especially for visual observations from Atari environments.</p>
</dd>
<dt>Interfaces:</dt><dd><p>__init__, observation</p>
</dd>
<dt>Properties:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): the environment to wrap.</p></li>
<li><p>size (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): the size to which the frames are to be resized.</p></li>
<li><p>observation_space (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Space</span></code>): the observation space of the wrapped environment.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.WarpFrameWrapper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">84</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#WarpFrameWrapper.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.WarpFrameWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Constructor for WarpFrameWrapper class, initializes the environment and the size.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): the environment to wrap.</p></li>
<li><p>size (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): the size to which the frames are to be resized. Default is 84.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.WarpFrameWrapper.observation">
<span class="sig-name descname"><span class="pre">observation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#WarpFrameWrapper.observation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.WarpFrameWrapper.observation" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Resize the frame (observation) to the desired size.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>frame (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): the frame to be resized.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>frame (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): the resized frame.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="actionrepeatwrapper">
<h3>ActionRepeatWrapper<a class="headerlink" href="#actionrepeatwrapper" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.ActionRepeatWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">ActionRepeatWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_repeat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#ActionRepeatWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.ActionRepeatWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Overview:</dt><dd><p>The ActionRepeatWrapper class is a gym wrapper that repeats the same action for a number of steps.
This wrapper is particularly useful in environments where the desired effect is achieved by maintaining
the same action across multiple time steps. For instance, some physical environments like motion control
tasks might require consistent force input to produce a significant state change.</p>
<p>Using this wrapper can reduce the temporal complexity of the problem, as it allows the agent to perform
multiple actions within a single time step. This can speed up learning, as the agent has fewer decisions
to make within a time step. However, it may also sacrifice some level of decision-making precision, as the
agent cannot change its action across successive time steps.</p>
<p>Note that the use of the ActionRepeatWrapper may not be suitable for all types of environments. Specifically,
it may not be the best choice for environments where new decisions must be made at each time step, or where
the time sequence of actions has a significant impact on the outcome.</p>
</dd>
<dt>Interfaces:</dt><dd><p>__init__, step</p>
</dd>
<dt>Properties:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): the environment to wrap.</p></li>
<li><p>action_repeat (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): the number of times to repeat the action.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.ActionRepeatWrapper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_repeat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#ActionRepeatWrapper.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.ActionRepeatWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the ActionRepeatWrapper class.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): the environment to wrap.</p></li>
<li><p>action_repeat (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): the number of times to repeat the action. Default is 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.ActionRepeatWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#ActionRepeatWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.ActionRepeatWrapper.step" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Take the given action and repeat it for a specified number of steps. The rewards are summed up.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>action (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[int,</span> <span class="pre">np.ndarray]</span></code>): The action to repeat.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>obs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): The observation after repeating the action.</p></li>
<li><p>reward (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>): The sum of rewards after repeating the action.</p></li>
<li><p>done (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether the episode has ended.</p></li>
<li><p>info (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict</span></code>): Contains auxiliary diagnostic information.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="delayrewardwrapper">
<h3>DelayRewardWrapper<a class="headerlink" href="#delayrewardwrapper" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.DelayRewardWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">DelayRewardWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delay_reward_step</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#DelayRewardWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.DelayRewardWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Overview:</dt><dd><p>The DelayRewardWrapper class is a gym wrapper that delays the reward. It cumulates the reward over a
predefined number of steps and returns the cumulated reward only at the end of this interval.
At other times, it returns a reward of 0.</p>
<p>This wrapper is particularly useful in environments where the impact of an action is not immediately
observable, but rather delayed over several steps. For instance, in strategic games or planning tasks,
the effect of an action may not be directly noticeable, but it contributes to a sequence of actions that
leads to a reward. In these cases, delaying the reward to match the action-effect delay can make the
learning process more consistent with the problem’s nature.</p>
<p>However, using this wrapper may increase the difficulty of learning, as the agent needs to associate its
actions with delayed outcomes. It also introduces a non-standard reward structure, which could limit the
applicability of certain reinforcement learning algorithms.</p>
<p>Note that the use of the DelayRewardWrapper may not be suitable for all types of environments. Specifically,
it may not be the best choice for environments where the effect of actions is immediately observable and the
reward should be assigned accordingly.</p>
</dd>
<dt>Interfaces:</dt><dd><p>__init__, reset, step</p>
</dd>
<dt>Properties:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): the environment to wrap.</p></li>
<li><p>delay_reward_step (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): the number of steps over which to delay and cumulate the reward.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.DelayRewardWrapper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delay_reward_step</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#DelayRewardWrapper.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.DelayRewardWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the DelayRewardWrapper class.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): the environment to wrap.</p></li>
<li><p>delay_reward_step (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): the number of steps over which to delay and cumulate the reward.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.DelayRewardWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#DelayRewardWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.DelayRewardWrapper.reset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Resets the state of the environment and resets the delay reward duration and current delay reward.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>obs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): the initial observation of the environment.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.DelayRewardWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#DelayRewardWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.DelayRewardWrapper.step" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Take the given action and repeat it for a specified number of steps. The rewards are summed up.
If the number of steps equals the delay reward step, return the cumulated reward and reset the
delay reward duration and current delay reward. Otherwise, return a reward of 0.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>action (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[int,</span> <span class="pre">np.ndarray]</span></code>): the action to take in the step.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>obs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): The observation after the step.</p></li>
<li><p>reward (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>): The cumulated reward after the delay reward step or 0.</p></li>
<li><p>done (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether the episode has ended.</p></li>
<li><p>info (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict</span></code>): Contains auxiliary diagnostic information.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="obstransposewrapper">
<h3>ObsTransposeWrapper<a class="headerlink" href="#obstransposewrapper" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.ObsTransposeWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">ObsTransposeWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#ObsTransposeWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.ObsTransposeWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The ObsTransposeWrapper class is a gym wrapper that transposes the observation to put the channel dimension
first. This can be helpful for certain types of neural networks that expect the channel dimension to be
the first dimension.</p>
</dd>
<dt>Interfaces:</dt><dd><p>__init__, observation</p>
</dd>
<dt>Properties:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): The environment to wrap.</p></li>
<li><p>observation_space (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.spaces.Box</span></code>): The transformed observation space.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.ObsTransposeWrapper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#ObsTransposeWrapper.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.ObsTransposeWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the ObsTransposeWrapper class and update the observation space according to the environment’s
observation space.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): The environment to wrap.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.ObsTransposeWrapper.observation">
<span class="sig-name descname"><span class="pre">observation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#ObsTransposeWrapper.observation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.ObsTransposeWrapper.observation" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Transpose the observation to put the channel dimension first. If the observation is a tuple, each element
in the tuple is transposed independently.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>obs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[tuple,</span> <span class="pre">np.ndarray]</span></code>): The original observation.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>obs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[tuple,</span> <span class="pre">np.ndarray]</span></code>): The transposed observation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="obsnormwrapper">
<h3>ObsNormWrapper<a class="headerlink" href="#obsnormwrapper" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.ObsNormWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">ObsNormWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#ObsNormWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.ObsNormWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The ObsNormWrapper class is a gym observation wrapper that normalizes
observations according to running mean and standard deviation (std).</p>
</dd>
<dt>Interfaces:</dt><dd><p>__init__, step, reset, observation</p>
</dd>
<dt>Properties:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): the environment to wrap.</p></li>
<li><p>data_count (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): the count of data points observed so far.</p></li>
<li><p>clip_range (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Tuple[int,</span> <span class="pre">int]</span></code>): the range to clip the normalized observation.</p></li>
<li><p>rms (<code class="xref py py-obj docutils literal notranslate"><span class="pre">RunningMeanStd</span></code>): running mean and standard deviation of the observations.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.ObsNormWrapper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#ObsNormWrapper.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.ObsNormWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the ObsNormWrapper class.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): the environment to wrap.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.ObsNormWrapper.observation">
<span class="sig-name descname"><span class="pre">observation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#ObsNormWrapper.observation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.ObsNormWrapper.observation" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Normalize the observation using the current running mean and std.
If less than 30 data points have been observed, return the original observation.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>observation (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): the original observation.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>observation (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): the normalized observation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.ObsNormWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#ObsNormWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.ObsNormWrapper.reset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset the environment and the properties related to the running mean and std.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>kwargs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict</span></code>): keyword arguments to be passed to the environment’s reset function.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>observation (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): the initial observation of the environment.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.ObsNormWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#ObsNormWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.ObsNormWrapper.step" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Take an action in the environment, update the running mean and std,
and return the normalized observation.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>action (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[int,</span> <span class="pre">np.ndarray]</span></code>): the action to take in the environment.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>obs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): the normalized observation after the action.</p></li>
<li><p>reward (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>): the reward after the action.</p></li>
<li><p>done (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): whether the episode has ended.</p></li>
<li><p>info (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict</span></code>): contains auxiliary diagnostic information.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="staticobsnormwrapper">
<h3>StaticObsNormWrapper<a class="headerlink" href="#staticobsnormwrapper" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.StaticObsNormWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">StaticObsNormWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#StaticObsNormWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.StaticObsNormWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>The StaticObsNormWrapper class is a gym observation wrapper that normalizes
observations according to a precomputed mean and standard deviation (std) from a fixed dataset.</p>
</dd>
<dt>Interfaces:</dt><dd><p>__init__, observation</p>
</dd>
<dt>Properties:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): the environment to wrap.</p></li>
<li><p>mean (<code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): the mean of the observations in the fixed dataset.</p></li>
<li><p>std (<code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): the standard deviation of the observations in the fixed dataset.</p></li>
<li><p>clip_range (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Tuple[int,</span> <span class="pre">int]</span></code>): the range to clip the normalized observation.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.StaticObsNormWrapper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#StaticObsNormWrapper.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.StaticObsNormWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the StaticObsNormWrapper class.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): the environment to wrap.</p></li>
<li><p>mean (<code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): the mean of the observations in the fixed dataset.</p></li>
<li><p>std (<code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): the standard deviation of the observations in the fixed dataset.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.StaticObsNormWrapper.observation">
<span class="sig-name descname"><span class="pre">observation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#StaticObsNormWrapper.observation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.StaticObsNormWrapper.observation" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Normalize the given observation using the precomputed mean and std.
The normalized observation is then clipped within the specified range.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>observation (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): the original observation.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>observation (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): the normalized and clipped observation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="rewardnormwrapper">
<h3>RewardNormWrapper<a class="headerlink" href="#rewardnormwrapper" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.RewardNormWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">RewardNormWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward_discount</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#RewardNormWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.RewardNormWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>This wrapper class normalizes the reward according to running std. It extends the <cite>gym.RewardWrapper</cite>.</p>
</dd>
<dt>Interfaces:</dt><dd><p>__init__, step, reward, reset</p>
</dd>
<dt>Properties:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): The environment to wrap.</p></li>
<li><p>cum_reward (<code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>): The cumulated reward, initialized as zero and updated in <cite>step</cite> method.</p></li>
<li><p>reward_discount (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>): The discount factor for reward.</p></li>
<li><p>data_count (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): A counter for data, incremented in each <cite>step</cite> call.</p></li>
<li><p>rms (<code class="xref py py-obj docutils literal notranslate"><span class="pre">RunningMeanStd</span></code>): An instance of RunningMeanStd to compute the running mean and std of reward.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.RewardNormWrapper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward_discount</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#RewardNormWrapper.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.RewardNormWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the RewardNormWrapper, setup the properties according to running mean and std.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): The environment to wrap.</p></li>
<li><p>reward_discount (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>): The discount factor for reward.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.RewardNormWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#RewardNormWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.RewardNormWrapper.reset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Resets the state of the environment and reset properties (<cite>NumType</cite> ones to 0,                 and <code class="docutils literal notranslate"><span class="pre">self.rms</span></code> as reset rms wrapper)</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>kwargs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict</span></code>): Reset with this key argumets</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.RewardNormWrapper.reward">
<span class="sig-name descname"><span class="pre">reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reward</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#RewardNormWrapper.reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.RewardNormWrapper.reward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Normalize reward if <cite>data_count</cite> is more than 30.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>reward (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>): The raw reward.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>reward (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>): Normalized reward.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.RewardNormWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span> </span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#RewardNormWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.RewardNormWrapper.step" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Step the environment with the given action, update properties and return the new observation, reward,
done status and info.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>action (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>): The action to execute in the environment.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>observation (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): Normalized observation after executing the action and updated <cite>self.rms</cite>.</p></li>
<li><dl class="simple">
<dt>reward (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>): Amount of reward returned after the action execution (normalized) and updated</dt><dd><p><cite>self.cum_reward</cite>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>done (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether the episode has ended, in which case further step() calls will return</dt><dd><p>undefined results.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>info (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict</span></code>): Contains auxiliary diagnostic information (helpful for debugging, and sometimes</dt><dd><p>learning).</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="ramwrapper">
<h3>RamWrapper<a class="headerlink" href="#ramwrapper" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.RamWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">RamWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#RamWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.RamWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>This wrapper class wraps a RAM environment into an image-like environment. It extends the <cite>gym.Wrapper</cite>.</p>
</dd>
<dt>Interfaces:</dt><dd><p>__init__, reset, step</p>
</dd>
<dt>Properties:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): The environment to wrap.</p></li>
<li><p>observation_space (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.spaces.Box</span></code>): The observation space of the wrapped environment.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.RamWrapper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#RamWrapper.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.RamWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the RamWrapper and set up the observation space to wrap the RAM environment.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): The environment to wrap.</p></li>
<li><p>render (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether to render the environment, default is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.RamWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#RamWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.RamWrapper.reset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Resets the state of the environment and returns a reshaped observation.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>observation (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): New observation after reset and reshaped.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.RamWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">,</span> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span> </span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#RamWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.RamWrapper.step" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Execute one step within the environment with the given action. Repeat action, sum reward and reshape the
observation.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>action (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>): The action to take in the environment.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>observation (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): Reshaped observation after step with type restriction.</p></li>
<li><p>reward (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>): Amount of reward returned after previous action.</p></li>
<li><p>done (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether the episode has ended, in which case further step() calls will return
undefined results.</p></li>
<li><p>info (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict</span></code>): Contains auxiliary diagnostic information (helpful for debugging, and sometimes
learning).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="evalepisodereturnwrapper">
<h3>EvalEpisodeReturnWrapper<a class="headerlink" href="#evalepisodereturnwrapper" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.EvalEpisodeReturnWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">EvalEpisodeReturnWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#EvalEpisodeReturnWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.EvalEpisodeReturnWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>A wrapper for a gym environment that accumulates rewards at every timestep, and returns the total reward at the
end of the episode in <cite>info</cite>. This is used for evaluation purposes.</p>
</dd>
<dt>Interfaces:</dt><dd><p>__init__, reset, step</p>
</dd>
<dt>Properties:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): the environment to wrap.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.EvalEpisodeReturnWrapper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#EvalEpisodeReturnWrapper.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.EvalEpisodeReturnWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the EvalEpisodeReturnWrapper. This involves setting up the environment to wrap.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): The environment to wrap.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.EvalEpisodeReturnWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#EvalEpisodeReturnWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.EvalEpisodeReturnWrapper.reset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Reset the environment and initialize the accumulated reward to zero.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>obs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): The initial observation from the environment.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.EvalEpisodeReturnWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#EvalEpisodeReturnWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.EvalEpisodeReturnWrapper.step" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Overview:</dt><dd><p>Step the environment with the provided action, accumulate the returned reward, and add the total reward to
<cite>info</cite> if the episode is done.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>action (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>): The action to take in the environment.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>obs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): The next observation from the environment.</p></li>
<li><p>reward (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>): The reward from taking the action.</p></li>
<li><p>done (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether the episode is done.</p></li>
<li><dl class="simple">
<dt>info (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>): A dictionary of extra information, which includes ‘eval_episode_return’ if</dt><dd><p>the episode is done.</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Examples:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;CartPole-v1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env</span> <span class="o">=</span> <span class="n">EvalEpisodeReturnWrapper</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">done</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">while</span> <span class="ow">not</span> <span class="n">done</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">action</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>  <span class="c1"># Replace with your own policy</span>
<span class="gp">... </span>    <span class="n">obs</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">done</span><span class="p">:</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total episode reward:&quot;</span><span class="p">,</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;eval_episode_return&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="gymhybriddictactionwrapper">
<h3>GymHybridDictActionWrapper<a class="headerlink" href="#gymhybriddictactionwrapper" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.GymHybridDictActionWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">GymHybridDictActionWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#GymHybridDictActionWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.GymHybridDictActionWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Transform Gym-Hybrid’s original <cite>gym.spaces.Tuple</cite> action space to <cite>gym.spaces.Dict</cite>.</p>
</dd>
<dt>Interfaces:</dt><dd><p>__init__, action</p>
</dd>
<dt>Properties:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): The environment to wrap.</p></li>
<li><p>action_space (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.spaces.Dict</span></code>): The new action space.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.GymHybridDictActionWrapper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#GymHybridDictActionWrapper.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.GymHybridDictActionWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the GymHybridDictActionWrapper, setting up the new action space.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): The environment to wrap.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.GymHybridDictActionWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span> </span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#GymHybridDictActionWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.GymHybridDictActionWrapper.step" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Execute the given action in the environment, transform the action from Dict to Tuple,
and return the new observation, reward, done status and info.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>action (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict</span></code>): The action to execute in the environment, structured as a dictionary.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>observation (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict</span></code>): The wrapped observation, which includes the current observation,</dt><dd><p>previous action and previous reward.</p>
</dd>
</dl>
</li>
<li><p>reward (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>): Amount of reward returned after the action execution.</p></li>
<li><dl class="simple">
<dt>done (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether the episode has ended, in which case further step() calls will return</dt><dd><p>undefined results.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>info (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict</span></code>): Contains auxiliary diagnostic information (helpful for debugging, and</dt><dd><p>sometimes learning).</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="obsplusprevactrewwrapper">
<h3>ObsPlusPrevActRewWrapper<a class="headerlink" href="#obsplusprevactrewwrapper" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.ObsPlusPrevActRewWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">ObsPlusPrevActRewWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#ObsPlusPrevActRewWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.ObsPlusPrevActRewWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>This wrapper is used in policy NGU. It sets a dict as the new wrapped observation,
which includes the current observation, previous action and previous reward.</p>
</dd>
<dt>Interfaces:</dt><dd><p>__init__, reset, step</p>
</dd>
<dt>Properties:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): The environment to wrap.</p></li>
<li><p>prev_action (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): The previous action.</p></li>
<li><p>prev_reward_extrinsic (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>): The previous reward.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.ObsPlusPrevActRewWrapper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#ObsPlusPrevActRewWrapper.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.ObsPlusPrevActRewWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the ObsPlusPrevActRewWrapper, setting up the previous action and reward.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): The environment to wrap.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.ObsPlusPrevActRewWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#ObsPlusPrevActRewWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.ObsPlusPrevActRewWrapper.reset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Resets the state of the environment, and returns the wrapped observation.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>observation (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict</span></code>): The wrapped observation, which includes the current observation,</dt><dd><p>previous action and previous reward.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.ObsPlusPrevActRewWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span> </span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#ObsPlusPrevActRewWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.ObsPlusPrevActRewWrapper.step" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Execute the given action in the environment, save the previous action and reward
to be used in the next observation, and return the new observation, reward,
done status and info.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>action (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>): The action to execute in the environment.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>observation (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict</span></code>): The wrapped observation, which includes the current observation,</dt><dd><p>previous action and previous reward.</p>
</dd>
</dl>
</li>
<li><p>reward (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>): Amount of reward returned after the action execution.</p></li>
<li><dl class="simple">
<dt>done (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether the episode has ended, in which case further step() calls will return</dt><dd><p>undefined results.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>info (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict</span></code>): Contains auxiliary diagnostic information (helpful for debugging, and sometimes</dt><dd><p>learning).</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="timelimitwrapper">
<h3>TimeLimitWrapper<a class="headerlink" href="#timelimitwrapper" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.TimeLimitWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">TimeLimitWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_limit</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#TimeLimitWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.TimeLimitWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>This class is used to enforce a time limit on the environment.</p>
</dd>
<dt>Interfaces:</dt><dd><p>__init__, reset, step</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.TimeLimitWrapper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_limit</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#TimeLimitWrapper.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.TimeLimitWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the TimeLimitWrapper, setting up the maximum limit of time steps.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): The environment to wrap.</p></li>
<li><p>max_limit (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): The maximum limit of time steps.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.TimeLimitWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#TimeLimitWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.TimeLimitWrapper.reset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Resets the state of the environment and the time counter.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>observation (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): The new observation after reset.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.TimeLimitWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span> </span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#TimeLimitWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.TimeLimitWrapper.step" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Execute the given action in the environment, update the time counter, and
return the new observation, reward, done status and info.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>action (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>): The action to execute in the environment.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>observation (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): The new observation after the action execution.</p></li>
<li><p>reward (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>): Amount of reward returned after the action execution.</p></li>
<li><dl class="simple">
<dt>done (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether the episode has ended, in which case further step() calls will return</dt><dd><p>undefined results.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>info (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict</span></code>): Contains auxiliary diagnostic information (helpful for debugging, and sometimes</dt><dd><p>learning).</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="flatobswrapper">
<h3>FlatObsWrapper<a class="headerlink" href="#flatobswrapper" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.FlatObsWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">FlatObsWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxStrLen</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">96</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#FlatObsWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.FlatObsWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>This class is used to flatten the observation space of the environment.
Note: only suitable for environments like minigrid.</p>
</dd>
<dt>Interfaces:</dt><dd><p>__init__, observation, reset, step</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.FlatObsWrapper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxStrLen</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">96</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#FlatObsWrapper.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.FlatObsWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the FlatObsWrapper, setup the new observation space.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): The environment to wrap.</p></li>
<li><p>maxStrLen (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): The maximum length of mission string, default is 96.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.FlatObsWrapper.observation">
<span class="sig-name descname"><span class="pre">observation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span> </span><span class="pre">Tuple</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#FlatObsWrapper.observation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.FlatObsWrapper.observation" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Process the observation, convert the mission into one-hot encoding and concatenate
it with the image data.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>obs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[np.ndarray,</span> <span class="pre">Tuple]</span></code>): The raw observation to process.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>obs (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): The processed observation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.FlatObsWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#FlatObsWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.FlatObsWrapper.reset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Resets the state of the environment and returns the processed observation.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>observation (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): The processed observation after reset.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.FlatObsWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span> </span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#FlatObsWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.FlatObsWrapper.step" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Execute the given action in the environment, and return the processed observation,
reward, done status, and info.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>observation (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): The processed observation after the action execution.</p></li>
<li><p>reward (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>): Amount of reward returned after the action execution.</p></li>
<li><dl class="simple">
<dt>done (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether the episode has ended, in which case further step() calls will return</dt><dd><p>undefined results.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>info (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict</span></code>): Contains auxiliary diagnostic information (helpful for debugging, and sometimes</dt><dd><p>learning).</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="gymtogymnasiumwrapper">
<h3>GymToGymnasiumWrapper<a class="headerlink" href="#gymtogymnasiumwrapper" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.GymToGymnasiumWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">GymToGymnasiumWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gymnasium.core.Env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#GymToGymnasiumWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.GymToGymnasiumWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>This class is used to wrap a gymnasium environment to a gym environment.</p>
</dd>
<dt>Interfaces:</dt><dd><p>__init__, seed, reset</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.GymToGymnasiumWrapper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gymnasium.core.Env</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#GymToGymnasiumWrapper.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.GymToGymnasiumWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the GymToGymnasiumWrapper.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gymnasium.Env</span></code>): The gymnasium environment to wrap.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.GymToGymnasiumWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#GymToGymnasiumWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.GymToGymnasiumWrapper.reset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Resets the state of the environment and returns the new observation. If a seed
was set, use it in the reset.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>observation (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>): The new observation after reset.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.GymToGymnasiumWrapper.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#GymToGymnasiumWrapper.seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.GymToGymnasiumWrapper.seed" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Set the seed for the environment.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>seed (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): The seed to set.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="allinobswrapper">
<h3>AllinObsWrapper<a class="headerlink" href="#allinobswrapper" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ding.envs.AllinObsWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">ding.envs.</span></span><span class="sig-name descname"><span class="pre">AllinObsWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#AllinObsWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.AllinObsWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>This wrapper is used in policy <code class="docutils literal notranslate"><span class="pre">Decision</span> <span class="pre">Transformer</span></code>, which is proposed in paper
<a class="reference external" href="https://arxiv.org/abs/2106.01345">https://arxiv.org/abs/2106.01345</a>. It sets a dict {‘obs’: obs, ‘reward’: reward}
as the new wrapped observation, which includes the current observation and previous reward.</p>
</dd>
<dt>Interfaces:</dt><dd><p>__init__, reset, step, seed</p>
</dd>
<dt>Properties:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): The environment to wrap.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.AllinObsWrapper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gym.core.Env</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#AllinObsWrapper.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.AllinObsWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Initialize the AllinObsWrapper.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>env (<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.Env</span></code>): The environment to wrap.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.AllinObsWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#AllinObsWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.AllinObsWrapper.reset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Resets the state of the environment and returns the new observation.</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>observation (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict</span></code>): The new observation after reset, includes the current observation and reward.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.AllinObsWrapper.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic_seed</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#AllinObsWrapper.seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.AllinObsWrapper.seed" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Set the seed for the environment.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>seed (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>): The seed to set.</p></li>
<li><p>dynamic_seed (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Whether to use dynamic seed, default is True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ding.envs.AllinObsWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ding/envs/env_wrappers/env_wrappers.html#AllinObsWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ding.envs.AllinObsWrapper.step" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Execute the given action in the environment, and return the new observation,
reward, done status, and info.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>action (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>): The action to execute in the environment.</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>timestep (<code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseEnvTimestep</span></code>): The timestep after the action execution.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
</section>


              </article>
              
            </div>
            <footer>
  
  <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
    
    <a href="model.html" class="btn btn-neutral float-right" title="ding.model" accesskey="n"
      rel="next">Next <img src="../_static/images/chevron-right-blue.svg"
        class="next-page"></a>
    
    
    <a href="config.html" class="btn btn-neutral" title="ding.config" accesskey="p"
      rel="prev"><img src="../_static/images/chevron-right-blue.svg" class="previous-page"> Previous</a>
    
  </div>
  

  <hr>

  <div role="contentinfo">
    <p>
      &copy; Copyright 2021, OpenDILab Contributors.

    </p>
  </div>
  
  <div>
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a
      href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the
      Docs</a>.
  </div>
   

</footer>
          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">ding.envs</a><ul>
<li><a class="reference internal" href="#env">Env</a><ul>
<li><a class="reference internal" href="#baseenv">BaseEnv</a></li>
<li><a class="reference internal" href="#get-vec-env-setting">get_vec_env_setting</a></li>
<li><a class="reference internal" href="#get-env-cls">get_env_cls</a></li>
<li><a class="reference internal" href="#dingenvwrapper">DingEnvWrapper</a></li>
<li><a class="reference internal" href="#get-default-wrappers">get_default_wrappers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#env-manager">Env Manager</a><ul>
<li><a class="reference internal" href="#create-env-manager">create_env_manager</a></li>
<li><a class="reference internal" href="#get-env-manager-cls">get_env_manager_cls</a></li>
<li><a class="reference internal" href="#baseenvmanager">BaseEnvManager</a></li>
<li><a class="reference internal" href="#baseenvmanagerv2">BaseEnvManagerV2</a></li>
<li><a class="reference internal" href="#syncsubprocessenvmanager">SyncSubprocessEnvManager</a></li>
<li><a class="reference internal" href="#subprocessenvmanagerv2">SubprocessEnvManagerV2</a></li>
<li><a class="reference internal" href="#asyncsubprocessenvmanager">AsyncSubprocessEnvManager</a></li>
<li><a class="reference internal" href="#gymvectorenvmanager">GymVectorEnvManager</a></li>
</ul>
</li>
<li><a class="reference internal" href="#env-wrapper">Env Wrapper</a><ul>
<li><a class="reference internal" href="#create-env-wrapper">create_env_wrapper</a></li>
<li><a class="reference internal" href="#update-shape">update_shape</a></li>
<li><a class="reference internal" href="#noopresetwrapper">NoopResetWrapper</a></li>
<li><a class="reference internal" href="#maxandskipwrapper">MaxAndSkipWrapper</a></li>
<li><a class="reference internal" href="#fireresetwrapper">FireResetWrapper</a></li>
<li><a class="reference internal" href="#episodiclifewrapper">EpisodicLifeWrapper</a></li>
<li><a class="reference internal" href="#cliprewardwrapper">ClipRewardWrapper</a></li>
<li><a class="reference internal" href="#framestackwrapper">FrameStackWrapper</a></li>
<li><a class="reference internal" href="#scaledfloatframewrapper">ScaledFloatFrameWrapper</a></li>
<li><a class="reference internal" href="#warpframewrapper">WarpFrameWrapper</a></li>
<li><a class="reference internal" href="#actionrepeatwrapper">ActionRepeatWrapper</a></li>
<li><a class="reference internal" href="#delayrewardwrapper">DelayRewardWrapper</a></li>
<li><a class="reference internal" href="#obstransposewrapper">ObsTransposeWrapper</a></li>
<li><a class="reference internal" href="#obsnormwrapper">ObsNormWrapper</a></li>
<li><a class="reference internal" href="#staticobsnormwrapper">StaticObsNormWrapper</a></li>
<li><a class="reference internal" href="#rewardnormwrapper">RewardNormWrapper</a></li>
<li><a class="reference internal" href="#ramwrapper">RamWrapper</a></li>
<li><a class="reference internal" href="#evalepisodereturnwrapper">EvalEpisodeReturnWrapper</a></li>
<li><a class="reference internal" href="#gymhybriddictactionwrapper">GymHybridDictActionWrapper</a></li>
<li><a class="reference internal" href="#obsplusprevactrewwrapper">ObsPlusPrevActRewWrapper</a></li>
<li><a class="reference internal" href="#timelimitwrapper">TimeLimitWrapper</a></li>
<li><a class="reference internal" href="#flatobswrapper">FlatObsWrapper</a></li>
<li><a class="reference internal" href="#gymtogymnasiumwrapper">GymToGymnasiumWrapper</a></li>
<li><a class="reference internal" href="#allinobswrapper">AllinObsWrapper</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
    </section>
  </div>

  


  

  
  <script type="text/javascript" id="documentation_options" data-url_root="../"
    src="../_static/documentation_options.js"></script>
  <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
  <script src="../_static/jquery.js"></script>
  <script src="../_static/underscore.js"></script>
  <script src="../_static/doctools.js"></script>
  

  

  <script type="text/javascript" src="../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
  </div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://di-engine-docs.readthedocs.io/en/latest/" aria-label="OpenMMLab"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://github.com/opendilab/DI-engine" target="_blank">GitHub</a>
          </li>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function () {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function (e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>

</html>